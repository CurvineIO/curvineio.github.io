"use strict";(self.webpackChunkcurvine_doc=self.webpackChunkcurvine_doc||[]).push([[652],{3190:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>r,default:()=>x,frontMatter:()=>d,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"User-Manuals/s3-gateway","title":"S3 \u5bf9\u8c61\u5b58\u50a8\u7f51\u5173","description":"\u6982\u8ff0","source":"@site/i18n/zh-cn/docusaurus-plugin-content-docs/current/3-User-Manuals/08-s3-gateway.md","sourceDirName":"3-User-Manuals","slug":"/User-Manuals/s3-gateway","permalink":"/zh-cn/docs/User-Manuals/s3-gateway","draft":false,"unlisted":false,"editUrl":"https://github.com/curvineio/curvine-doc/edit/main/docs/3-User-Manuals/08-s3-gateway.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Fuse\u6a21\u5f0f\u8bbf\u95ee","permalink":"/zh-cn/docs/User-Manuals/fuse"},"next":{"title":"Benchmark","permalink":"/zh-cn/docs/category/benchmark"}}');var l=s(4848),c=s(8453);const d={},r="S3 \u5bf9\u8c61\u5b58\u50a8\u7f51\u5173",t={},h=[{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:2},{value:"\u4e3b\u8981\u7279\u6027",id:"\u4e3b\u8981\u7279\u6027",level:3},{value:"\u67b6\u6784\u8bf4\u660e",id:"\u67b6\u6784\u8bf4\u660e",level:3},{value:"\u652f\u6301\u7684 S3 \u64cd\u4f5c",id:"\u652f\u6301\u7684-s3-\u64cd\u4f5c",level:2},{value:"\u5bf9\u8c61\u64cd\u4f5c",id:"\u5bf9\u8c61\u64cd\u4f5c",level:3},{value:"\u5b58\u50a8\u6876\u64cd\u4f5c",id:"\u5b58\u50a8\u6876\u64cd\u4f5c",level:3},{value:"\u9ad8\u7ea7\u529f\u80fd",id:"\u9ad8\u7ea7\u529f\u80fd",level:3},{value:"\u670d\u52a1\u7ba1\u7406",id:"\u670d\u52a1\u7ba1\u7406",level:2},{value:"\u542f\u52a8\u670d\u52a1",id:"\u542f\u52a8\u670d\u52a1",level:3},{value:"\u505c\u6b62\u670d\u52a1",id:"\u505c\u6b62\u670d\u52a1",level:3},{value:"\u67e5\u770b\u670d\u52a1\u72b6\u6001",id:"\u67e5\u770b\u670d\u52a1\u72b6\u6001",level:3},{value:"\u91cd\u542f\u670d\u52a1",id:"\u91cd\u542f\u670d\u52a1",level:3},{value:"\u67e5\u770b\u65e5\u5fd7",id:"\u67e5\u770b\u65e5\u5fd7",level:3},{value:"\u542f\u52a8\u53c2\u6570",id:"\u542f\u52a8\u53c2\u6570",level:2},{value:"\u547d\u4ee4\u884c\u53c2\u6570",id:"\u547d\u4ee4\u884c\u53c2\u6570",level:3},{value:"\u914d\u7f6e\u6587\u4ef6\u53c2\u6570",id:"\u914d\u7f6e\u6587\u4ef6\u53c2\u6570",level:3},{value:"\u73af\u5883\u53d8\u91cf",id:"\u73af\u5883\u53d8\u91cf",level:3},{value:"\u51ed\u636e\u7ba1\u7406",id:"\u51ed\u636e\u7ba1\u7406",level:2},{value:"\u6dfb\u52a0\u51ed\u636e",id:"\u6dfb\u52a0\u51ed\u636e",level:3},{value:"\u751f\u6210\u968f\u673a\u51ed\u636e",id:"\u751f\u6210\u968f\u673a\u51ed\u636e",level:3},{value:"\u5217\u51fa\u51ed\u636e",id:"\u5217\u51fa\u51ed\u636e",level:3},{value:"\u67e5\u770b\u7f13\u5b58\u7edf\u8ba1",id:"\u67e5\u770b\u7f13\u5b58\u7edf\u8ba1",level:3},{value:"\u51ed\u636e\u5b58\u50a8",id:"\u51ed\u636e\u5b58\u50a8",level:3},{value:"\u4f7f\u7528\u793a\u4f8b",id:"\u4f7f\u7528\u793a\u4f8b",level:2},{value:"AWS CLI",id:"aws-cli",level:3},{value:"MinIO \u5ba2\u6237\u7aef (mc)",id:"minio-\u5ba2\u6237\u7aef-mc",level:3},{value:"Python boto3",id:"python-boto3",level:3},{value:"Range \u8bf7\u6c42\u793a\u4f8b",id:"range-\u8bf7\u6c42\u793a\u4f8b",level:3},{value:"\u591a\u5b9e\u4f8b\u90e8\u7f72",id:"\u591a\u5b9e\u4f8b\u90e8\u7f72",level:2},{value:"\u8d1f\u8f7d\u5747\u8861\u914d\u7f6e",id:"\u8d1f\u8f7d\u5747\u8861\u914d\u7f6e",level:3},{value:"\u4f7f\u7528 Nginx",id:"\u4f7f\u7528-nginx",level:4},{value:"\u4f7f\u7528 HAProxy",id:"\u4f7f\u7528-haproxy",level:4},{value:"\u591a\u5b9e\u4f8b\u542f\u52a8",id:"\u591a\u5b9e\u4f8b\u542f\u52a8",level:3},{value:"\u9ad8\u53ef\u7528\u914d\u7f6e",id:"\u9ad8\u53ef\u7528\u914d\u7f6e",level:3},{value:"\u914d\u7f6e\u5171\u4eab\u5b58\u50a8",id:"\u914d\u7f6e\u5171\u4eab\u5b58\u50a8",level:4},{value:"\u5065\u5eb7\u68c0\u67e5",id:"\u5065\u5eb7\u68c0\u67e5",level:4},{value:"\u6027\u80fd\u4f18\u5316",id:"\u6027\u80fd\u4f18\u5316",level:3},{value:"\u7cfb\u7edf\u7ea7\u4f18\u5316",id:"\u7cfb\u7edf\u7ea7\u4f18\u5316",level:4},{value:"\u914d\u7f6e\u8c03\u4f18",id:"\u914d\u7f6e\u8c03\u4f18",level:4},{value:"\u6545\u969c\u6392\u9664",id:"\u6545\u969c\u6392\u9664",level:2},{value:"\u5e38\u89c1\u95ee\u9898",id:"\u5e38\u89c1\u95ee\u9898",level:3},{value:"\u8c03\u8bd5\u6a21\u5f0f",id:"\u8c03\u8bd5\u6a21\u5f0f",level:3}];function a(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"s3-\u5bf9\u8c61\u5b58\u50a8\u7f51\u5173",children:"S3 \u5bf9\u8c61\u5b58\u50a8\u7f51\u5173"})}),"\n",(0,l.jsx)(n.h2,{id:"\u6982\u8ff0",children:"\u6982\u8ff0"}),"\n",(0,l.jsx)(n.p,{children:"Curvine S3 \u5bf9\u8c61\u5b58\u50a8\u7f51\u5173\u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u3001\u4f01\u4e1a\u7ea7\u7684 S3 \u517c\u5bb9\u7f51\u5173\uff0c\u4e3a Curvine \u5206\u5e03\u5f0f\u6587\u4ef6\u7f13\u5b58\u7cfb\u7edf\u63d0\u4f9b\u6807\u51c6\u7684 AWS S3 API \u8bbf\u95ee\u80fd\u529b\u3002\u901a\u8fc7\u8fd9\u4e2a\u7f51\u5173\uff0c\u7528\u6237\u53ef\u4ee5\u4f7f\u7528\u4efb\u4f55\u652f\u6301 S3 \u534f\u8bae\u7684\u5de5\u5177\u548c\u5e94\u7528\u7a0b\u5e8f\u6765\u8bbf\u95ee Curvine \u5b58\u50a8\u7684\u6570\u636e\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"\u4e3b\u8981\u7279\u6027",children:"\u4e3b\u8981\u7279\u6027"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5b8c\u5168\u517c\u5bb9 S3 API"}),"\uff1a\u652f\u6301\u6240\u6709\u5e38\u7528\u7684 S3 \u64cd\u4f5c\uff0c\u5305\u62ec\u5bf9\u8c61\u548c\u5b58\u50a8\u6876\u7ba1\u7406"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u9ad8\u6027\u80fd\u67b6\u6784"}),"\uff1a\u57fa\u4e8e Rust \u548c Axum \u6784\u5efa\uff0c\u652f\u6301\u5f02\u6b65\u9ad8\u541e\u5410\u91cf\u5904\u7406"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u4f01\u4e1a\u7ea7\u5b89\u5168"}),"\uff1a\u652f\u6301 AWS Signature V2/V4 \u8ba4\u8bc1\uff0c\u5b8c\u6574\u7684\u6743\u9650\u63a7\u5236"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7075\u6d3b\u90e8\u7f72"}),"\uff1a\u652f\u6301\u72ec\u7acb\u90e8\u7f72"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6d41\u5f0f\u4f20\u8f93"}),"\uff1a\u5185\u5b58\u9ad8\u6548\u7684\u5927\u6587\u4ef6\u5904\u7406"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Range \u8bf7\u6c42"}),"\uff1a\u652f\u6301 HTTP Range \u8bf7\u6c42\u548c\u90e8\u5206\u5185\u5bb9\u4e0b\u8f7d"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u591a\u90e8\u5206\u4e0a\u4f20"}),"\uff1a\u652f\u6301\u5927\u6587\u4ef6\u5206\u5757\u4e0a\u4f20"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u8d1f\u8f7d\u5747\u8861"}),"\uff1a\u652f\u6301\u591a\u5b9e\u4f8b\u90e8\u7f72\u63d0\u5347\u6027\u80fd"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u67b6\u6784\u8bf4\u660e",children:"\u67b6\u6784\u8bf4\u660e"}),"\n",(0,l.jsx)(n.p,{children:"S3 \u7f51\u5173\u4f5c\u4e3a Curvine \u7cfb\u7edf\u7684\u524d\u7aef\u63a5\u53e3\uff0c\u5c06\u6807\u51c6\u7684 S3 API \u8bf7\u6c42\u8f6c\u6362\u4e3a Curvine \u6587\u4ef6\u7cfb\u7edf\u64cd\u4f5c\uff1a"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"Curvine S3 Gateway Architecture",src:s(8388).A+"",width:"600",height:"200"})}),"\n",(0,l.jsx)(n.h2,{id:"\u652f\u6301\u7684-s3-\u64cd\u4f5c",children:"\u652f\u6301\u7684 S3 \u64cd\u4f5c"}),"\n",(0,l.jsx)(n.h3,{id:"\u5bf9\u8c61\u64cd\u4f5c",children:"\u5bf9\u8c61\u64cd\u4f5c"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"PutObject"})," - \u4e0a\u4f20\u5bf9\u8c61"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"GetObject"})," - \u4e0b\u8f7d\u5bf9\u8c61"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"HeadObject"})," - \u83b7\u53d6\u5bf9\u8c61\u5143\u6570\u636e"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"DeleteObject"})," - \u5220\u9664\u5bf9\u8c61"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"CopyObject"})," - \u590d\u5236\u5bf9\u8c61\uff08\u89c4\u5212\u4e2d\uff09"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u5b58\u50a8\u6876\u64cd\u4f5c",children:"\u5b58\u50a8\u6876\u64cd\u4f5c"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"CreateBucket"})," - \u521b\u5efa\u5b58\u50a8\u6876"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"DeleteBucket"})," - \u5220\u9664\u5b58\u50a8\u6876"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"HeadBucket"})," - \u68c0\u67e5\u5b58\u50a8\u6876\u662f\u5426\u5b58\u5728"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ListObjects"})," - \u5217\u51fa\u5b58\u50a8\u6876\u4e2d\u7684\u5bf9\u8c61"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"GetBucketLocation"})," - \u83b7\u53d6\u5b58\u50a8\u6876\u4f4d\u7f6e"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u9ad8\u7ea7\u529f\u80fd",children:"\u9ad8\u7ea7\u529f\u80fd"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Range \u8bf7\u6c42"}),"\uff1a\u652f\u6301 HTTP Range \u5934\u8fdb\u884c\u90e8\u5206\u5185\u5bb9\u4e0b\u8f7d"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u591a\u90e8\u5206\u4e0a\u4f20"}),"\uff1a\u652f\u6301\u5927\u6587\u4ef6\u5206\u5757\u4e0a\u4f20"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6d41\u5f0f\u4f20\u8f93"}),"\uff1a\u5185\u5b58\u9ad8\u6548\u7684\u5927\u6587\u4ef6\u4f20\u8f93"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u670d\u52a1\u7ba1\u7406",children:"\u670d\u52a1\u7ba1\u7406"}),"\n",(0,l.jsxs)(n.p,{children:["S3 \u7f51\u5173\u63d0\u4f9b\u4e86\u4fbf\u6377\u7684\u670d\u52a1\u7ba1\u7406\u811a\u672c\uff0c\u4f4d\u4e8e ",(0,l.jsx)(n.code,{children:"build/bin/curvine-s3-gateway.sh"}),"\u3002"]}),"\n",(0,l.jsx)(n.h3,{id:"\u542f\u52a8\u670d\u52a1",children:"\u542f\u52a8\u670d\u52a1"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\u542f\u52a8\n./build/bin/curvine-s3-gateway.sh start\n\n# \u6307\u5b9a\u914d\u7f6e\u6587\u4ef6\u542f\u52a8\n./build/bin/curvine-s3-gateway.sh start --conf /path/to/curvine-cluster.toml\n\n# \u6307\u5b9a\u76d1\u542c\u5730\u5740\u548c\u533a\u57df\n./build/bin/curvine-s3-gateway.sh start \\\n    --listen 0.0.0.0:9000 \\\n    --region us-west-2\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u505c\u6b62\u670d\u52a1",children:"\u505c\u6b62\u670d\u52a1"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u4f18\u96c5\u505c\u6b62\u670d\u52a1\n./build/bin/curvine-s3-gateway.sh stop\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u67e5\u770b\u670d\u52a1\u72b6\u6001",children:"\u67e5\u770b\u670d\u52a1\u72b6\u6001"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\u670d\u52a1\u8fd0\u884c\u72b6\u6001\n./build/bin/curvine-s3-gateway.sh status\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u91cd\u542f\u670d\u52a1",children:"\u91cd\u542f\u670d\u52a1"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u91cd\u542f\u670d\u52a1\n./build/bin/curvine-s3-gateway.sh restart\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u67e5\u770b\u65e5\u5fd7",children:"\u67e5\u770b\u65e5\u5fd7"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\u5b9e\u65f6\u65e5\u5fd7\ntail -f ${CURVINE_HOME}/logs/curvine-s3-gateway.out\n\n# \u67e5\u770b\u6700\u8fd1\u7684\u65e5\u5fd7\ntail -100 ${CURVINE_HOME}/logs/curvine-s3-gateway.out\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u542f\u52a8\u53c2\u6570",children:"\u542f\u52a8\u53c2\u6570"}),"\n",(0,l.jsx)(n.h3,{id:"\u547d\u4ee4\u884c\u53c2\u6570",children:"\u547d\u4ee4\u884c\u53c2\u6570"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u53c2\u6570"}),(0,l.jsx)(n.th,{children:"\u63cf\u8ff0"}),(0,l.jsx)(n.th,{children:"\u9ed8\u8ba4\u503c"}),(0,l.jsx)(n.th,{children:"\u793a\u4f8b"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"--conf"})}),(0,l.jsx)(n.td,{children:"\u914d\u7f6e\u6587\u4ef6\u8def\u5f84"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"${CURVINE_HOME}/conf/curvine-cluster.toml"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"--conf /etc/curvine.toml"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"--listen"})}),(0,l.jsx)(n.td,{children:"\u76d1\u542c\u5730\u5740\u548c\u7aef\u53e3"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"0.0.0.0:9900"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"--listen 127.0.0.1:9000"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"--region"})}),(0,l.jsx)(n.td,{children:"S3 \u533a\u57df\u6807\u8bc6"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"us-east-1"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"--region us-west-2"})})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"\u914d\u7f6e\u6587\u4ef6\u53c2\u6570",children:"\u914d\u7f6e\u6587\u4ef6\u53c2\u6570"}),"\n",(0,l.jsxs)(n.p,{children:["\u5728 ",(0,l.jsx)(n.code,{children:"curvine-cluster.toml"})," \u4e2d\u7684 ",(0,l.jsx)(n.code,{children:"[s3_gateway]"})," \u90e8\u5206\u652f\u6301\u4ee5\u4e0b\u914d\u7f6e\u53c2\u6570\uff1a"]}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u53c2\u6570\u540d"}),(0,l.jsx)(n.th,{children:"\u7c7b\u578b"}),(0,l.jsx)(n.th,{children:"\u9ed8\u8ba4\u503c"}),(0,l.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"listen"})}),(0,l.jsx)(n.td,{children:"string"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'"0.0.0.0:9900"'})}),(0,l.jsx)(n.td,{children:"S3 \u7f51\u5173\u76d1\u542c\u5730\u5740\u548c\u7aef\u53e3"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"region"})}),(0,l.jsx)(n.td,{children:"string"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'"us-east-1"'})}),(0,l.jsx)(n.td,{children:"S3 \u533a\u57df\u6807\u8bc6\u7b26"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"put_temp_dir"})}),(0,l.jsx)(n.td,{children:"string"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'"/tmp/curvine-temp"'})}),(0,l.jsx)(n.td,{children:"PUT \u64cd\u4f5c\u4e34\u65f6\u76ee\u5f55\uff08\u5305\u62ec\u591a\u90e8\u5206\u4e0a\u4f20\u548c\u5e38\u89c4\u4e0a\u4f20\uff09"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"put_memory_buffer_threshold"})}),(0,l.jsx)(n.td,{children:"integer"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"1048576"})}),(0,l.jsx)(n.td,{children:"\u5c0f\u6587\u4ef6\u5185\u5b58\u7f13\u51b2\u533a\u9608\u503c\uff08\u5b57\u8282\uff0c\u9ed8\u8ba4 1MB\uff09"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"put_max_memory_buffer"})}),(0,l.jsx)(n.td,{children:"integer"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"16777216"})}),(0,l.jsx)(n.td,{children:"\u6700\u5927\u5185\u5b58\u7f13\u51b2\u533a\u5927\u5c0f\uff08\u5b57\u8282\uff0c\u9ed8\u8ba4 16MB\uff09"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"get_chunk_size_mb"})}),(0,l.jsx)(n.td,{children:"float"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"1.0"})}),(0,l.jsx)(n.td,{children:"GET \u64cd\u4f5c\u8bfb\u5199\u5757\u5927\u5c0f\uff08MB\uff0c\u53ef\u9009\uff1a0.5/1/2\uff09"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"enable_distributed_auth"})}),(0,l.jsx)(n.td,{children:"boolean"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"false"})}),(0,l.jsx)(n.td,{children:"\u542f\u7528\u5206\u5e03\u5f0f\u8ba4\u8bc1"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"credentials_path"})}),(0,l.jsx)(n.td,{children:"string"}),(0,l.jsx)(n.td,{children:"\u89c1\u8bf4\u660e"}),(0,l.jsx)(n.td,{children:"\u51ed\u636e\u6587\u4ef6\u8def\u5f84\uff0c\u6839\u636e\u8ba4\u8bc1\u6a21\u5f0f\u51b3\u5b9a"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"cache_refresh_interval_secs"})}),(0,l.jsx)(n.td,{children:"integer"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"30"})}),(0,l.jsx)(n.td,{children:"\u7f13\u5b58\u5237\u65b0\u95f4\u9694\uff08\u79d2\uff09"})]})]})]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u51ed\u636e\u8def\u5f84\u8bf4\u660e\uff1a"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"credentials_path"})," \u53c2\u6570\u7684\u503c\u6839\u636e ",(0,l.jsx)(n.code,{children:"enable_distributed_auth"})," \u8bbe\u7f6e\u51b3\u5b9a\uff1a"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u672c\u5730\u8ba4\u8bc1\u6a21\u5f0f"}),"\uff08",(0,l.jsx)(n.code,{children:"enable_distributed_auth = false"}),"\uff09\uff1a"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u9ed8\u8ba4\u8def\u5f84\uff1a",(0,l.jsx)(n.code,{children:"~/.curvine/credentials.jsonl"})]}),"\n",(0,l.jsx)(n.li,{children:"\u51ed\u636e\u5b58\u50a8\u5728\u672c\u5730\u6587\u4ef6\u7cfb\u7edf"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u5206\u5e03\u5f0f\u8ba4\u8bc1\u6a21\u5f0f"}),"\uff08",(0,l.jsx)(n.code,{children:"enable_distributed_auth = true"}),"\uff09\uff1a"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u9ed8\u8ba4\u8def\u5f84\uff1a",(0,l.jsx)(n.code,{children:"/system/auth/credentials.jsonl"})]}),"\n",(0,l.jsx)(n.li,{children:"\u51ed\u636e\u5b58\u50a8\u5728 Curvine \u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u4e2d"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u914d\u7f6e\u793a\u4f8b\uff1a"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:'[s3_gateway]\n# S3 \u7f51\u5173\u76d1\u542c\u5730\u5740\uff08\u4e3b\u673a:\u7aef\u53e3\uff09\nlisten = "0.0.0.0:9900"\n\n# S3 \u533a\u57df\nregion = "us-east-1"\n\n# \u6240\u6709 PUT \u64cd\u4f5c\u7684\u4e34\u65f6\u76ee\u5f55\uff08\u591a\u90e8\u5206\u4e0a\u4f20\u548c\u5e38\u89c4\u4e0a\u4f20\uff09\nput_temp_dir = "/tmp/curvine-temp"\n\n# \u5c0f\u6587\u4ef6\u5185\u5b58\u7f13\u51b2\u533a\u9608\u503c\uff08\u5b57\u8282\uff0c\u9ed8\u8ba4\uff1a1MB\uff09\nput_memory_buffer_threshold = 1048576\n\n# \u6700\u5927\u5185\u5b58\u7f13\u51b2\u533a\u5927\u5c0f\uff08\u5b57\u8282\uff0c\u9ed8\u8ba4\uff1a16MB\uff09\nput_max_memory_buffer = 16777216\n\n# GET \u6027\u80fd\u4f18\u5316\u8bbe\u7f6e\n# GET \u8bfb\u5199\u5757\u5927\u5c0f\uff08MB\uff0c\u9ed8\u8ba4\uff1a1.0\uff0c\u9009\u9879\uff1a0.5/1/2\uff09\nget_chunk_size_mb = 1.0\n\n# \u8ba4\u8bc1\u6a21\u5f0f\u914d\u7f6e\n# \u672c\u5730\u8ba4\u8bc1\u6a21\u5f0f\uff08\u9ed8\u8ba4\uff09\nenable_distributed_auth = false\ncredentials_path = "~/.curvine/credentials.jsonl"\n\n# \u5206\u5e03\u5f0f\u8ba4\u8bc1\u6a21\u5f0f\uff08\u53ef\u9009\uff09\n# enable_distributed_auth = true\n# credentials_path = "/system/auth/credentials.jsonl"\n\n# \u7f13\u5b58\u5237\u65b0\u95f4\u9694\uff08\u79d2\uff09\ncache_refresh_interval_secs = 30\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u73af\u5883\u53d8\u91cf",children:"\u73af\u5883\u53d8\u91cf"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u53d8\u91cf\u540d"}),(0,l.jsx)(n.th,{children:"\u63cf\u8ff0"}),(0,l.jsx)(n.th,{children:"\u8bf4\u660e"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"AWS_ACCESS_KEY_ID"})," \u6216 ",(0,l.jsx)(n.code,{children:"S3_ACCESS_KEY"})]}),(0,l.jsx)(n.td,{children:"S3 \u8bbf\u95ee\u5bc6\u94a5"}),(0,l.jsx)(n.td,{children:"\u542f\u52a8\u65f6\u4ece\u73af\u5883\u53d8\u91cf\u8bfb\u53d6\uff0c\u65e0\u9ed8\u8ba4\u503c"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"AWS_SECRET_ACCESS_KEY"})," \u6216 ",(0,l.jsx)(n.code,{children:"S3_SECRET_KEY"})]}),(0,l.jsx)(n.td,{children:"S3 \u5bc6\u94a5"}),(0,l.jsx)(n.td,{children:"\u542f\u52a8\u65f6\u4ece\u73af\u5883\u53d8\u91cf\u8bfb\u53d6\uff0c\u65e0\u9ed8\u8ba4\u503c"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"RUST_LOG"})}),(0,l.jsx)(n.td,{children:"\u65e5\u5fd7\u7ea7\u522b"}),(0,l.jsxs)(n.td,{children:["\u9ed8\u8ba4 ",(0,l.jsx)(n.code,{children:"info"}),"\uff0c\u53ef\u8bbe\u7f6e ",(0,l.jsx)(n.code,{children:"debug"}),"\u3001",(0,l.jsx)(n.code,{children:"trace"})," \u7b49"]})]})]})]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u51ed\u636e\u73af\u5883\u53d8\u91cf\u8bf4\u660e\uff1a"})}),"\n",(0,l.jsx)(n.p,{children:"\u7f51\u5173\u542f\u52a8\u65f6\u4f1a\u81ea\u52a8\u8bfb\u53d6\u4ee5\u4e0b\u73af\u5883\u53d8\u91cf\u4f5c\u4e3a\u9ed8\u8ba4\u51ed\u636e\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# \u8bbe\u7f6e\u8bbf\u95ee\u5bc6\u94a5\uff08\u4e24\u79cd\u65b9\u5f0f\u4efb\u9009\u5176\u4e00\uff09\nexport AWS_ACCESS_KEY_ID="your-access-key"\n# \u6216\u8005\nexport S3_ACCESS_KEY="your-access-key"\n\n# \u8bbe\u7f6e\u5bc6\u94a5\uff08\u4e24\u79cd\u65b9\u5f0f\u4efb\u9009\u5176\u4e00\uff09\nexport AWS_SECRET_ACCESS_KEY="your-secret-key"\n# \u6216\u8005\nexport S3_SECRET_KEY="your-secret-key"\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u5982\u679c\u8bbe\u7f6e\u4e86\u8fd9\u4e9b\u73af\u5883\u53d8\u91cf\uff0c\u7f51\u5173\u542f\u52a8\u65f6\u4f1a\u81ea\u52a8\u5c06\u8fd9\u4e9b\u51ed\u636e\u6dfb\u52a0\u5230\u51ed\u636e\u5b58\u50a8\u4e2d\uff0c\u65e0\u9700\u624b\u52a8\u914d\u7f6e\u3002"}),"\n",(0,l.jsx)(n.h2,{id:"\u51ed\u636e\u7ba1\u7406",children:"\u51ed\u636e\u7ba1\u7406"}),"\n",(0,l.jsx)(n.p,{children:"S3 \u7f51\u5173\u63d0\u4f9b\u4e86\u5b8c\u6574\u7684\u51ed\u636e\u7ba1\u7406\u529f\u80fd\uff0c\u652f\u6301\u6dfb\u52a0\u3001\u751f\u6210\u3001\u5217\u51fa\u548c\u7ba1\u7406\u8bbf\u95ee\u51ed\u636e\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"\u6dfb\u52a0\u51ed\u636e",children:"\u6dfb\u52a0\u51ed\u636e"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# \u6dfb\u52a0\u65b0\u7684\u8bbf\u95ee\u51ed\u636e\n./build/bin/curvine-s3-gateway.sh credential add \\\n    --access-key AKIAEXAMPLEKEY123 \\\n    --secret-key wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY \\\n    --description "\u751f\u4ea7\u73af\u5883\u8bbf\u95ee\u5bc6\u94a5"\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u751f\u6210\u968f\u673a\u51ed\u636e",children:"\u751f\u6210\u968f\u673a\u51ed\u636e"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# \u751f\u6210\u65b0\u7684\u968f\u673a\u51ed\u636e\n./build/bin/curvine-s3-gateway.sh credential generate \\\n    --description "\u81ea\u52a8\u751f\u6210\u7684\u6d4b\u8bd5\u5bc6\u94a5"\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u5217\u51fa\u51ed\u636e",children:"\u5217\u51fa\u51ed\u636e"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u5217\u51fa\u6240\u6709\u51ed\u636e\uff08\u9690\u85cf\u5bc6\u94a5\uff09\n./build/bin/curvine-s3-gateway.sh credential list\n\n# \u663e\u793a\u5b8c\u6574\u51ed\u636e\u4fe1\u606f\uff08\u5305\u542b\u5bc6\u94a5\uff09\n./build/bin/curvine-s3-gateway.sh credential list --show-secrets\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u67e5\u770b\u7f13\u5b58\u7edf\u8ba1",children:"\u67e5\u770b\u7f13\u5b58\u7edf\u8ba1"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\u51ed\u636e\u7f13\u5b58\u7edf\u8ba1\u4fe1\u606f\n./build/bin/curvine-s3-gateway.sh credential stats\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u51ed\u636e\u5b58\u50a8",children:"\u51ed\u636e\u5b58\u50a8"}),"\n",(0,l.jsx)(n.p,{children:"\u51ed\u636e\u4ee5 JSONL \u683c\u5f0f\u5b58\u50a8\uff1a"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u672c\u5730\u6a21\u5f0f"}),"\uff1a",(0,l.jsx)(n.code,{children:"~/.curvine/credentials.jsonl"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5206\u5e03\u5f0f\u6a21\u5f0f"}),"\uff1a",(0,l.jsx)(n.code,{children:"/system/auth/credentials.jsonl"})]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"\u6bcf\u4e2a\u51ed\u636e\u6761\u76ee\u5305\u542b\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "access_key": "AKIAEXAMPLEKEY123",\n  "secret_key": "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY",\n  "created_at": 1640995200,\n  "enabled": true,\n  "description": "\u751f\u4ea7\u73af\u5883\u8bbf\u95ee\u5bc6\u94a5"\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u4f7f\u7528\u793a\u4f8b",children:"\u4f7f\u7528\u793a\u4f8b"}),"\n",(0,l.jsx)(n.h3,{id:"aws-cli",children:"AWS CLI"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u914d\u7f6e\u73af\u5883\u53d8\u91cf\nexport AWS_ACCESS_KEY_ID=AqU4axe4feDyIielarPI\nexport AWS_SECRET_ACCESS_KEY=0CJZ2QfHi2tDb4DKuCJ2vnBEUXg5EYQt\nexport AWS_DEFAULT_REGION=us-east-1\n\n# \u521b\u5efa\u5b58\u50a8\u6876\naws s3 mb s3://my-bucket --endpoint-url http://localhost:9900\n\n# \u4e0a\u4f20\u6587\u4ef6\naws s3 cp /path/to/local/file.txt s3://my-bucket/ --endpoint-url http://localhost:9900\n\n# \u4e0b\u8f7d\u6587\u4ef6\naws s3 cp s3://my-bucket/file.txt /tmp/ --endpoint-url http://localhost:9900\n\n# \u5217\u51fa\u5bf9\u8c61\naws s3 ls s3://my-bucket/ --endpoint-url http://localhost:9900\n\n# \u5220\u9664\u5bf9\u8c61\naws s3 rm s3://my-bucket/file.txt --endpoint-url http://localhost:9900\n\n# \u540c\u6b65\u76ee\u5f55\naws s3 sync /local/directory s3://my-bucket/prefix/ --endpoint-url http://localhost:9900\n"})}),"\n",(0,l.jsx)(n.h3,{id:"minio-\u5ba2\u6237\u7aef-mc",children:"MinIO \u5ba2\u6237\u7aef (mc)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u914d\u7f6e MinIO \u5ba2\u6237\u7aef\nmc alias set curvine http://localhost:9900 AqU4axe4feDyIielarPI 0CJZ2QfHi2tDb4DKuCJ2vnBEUXg5EYQt\n\n# \u521b\u5efa\u5b58\u50a8\u6876\nmc mb curvine/my-bucket\n\n# \u4e0a\u4f20\u6587\u4ef6\nmc cp /path/to/file.txt curvine/my-bucket/\n\n# \u4e0b\u8f7d\u6587\u4ef6\nmc cp curvine/my-bucket/file.txt /tmp/\n\n# \u5217\u51fa\u5185\u5bb9\nmc ls curvine/my-bucket/\n\n# \u955c\u50cf\u76ee\u5f55\nmc mirror /local/directory curvine/my-bucket/prefix/\n"})}),"\n",(0,l.jsx)(n.h3,{id:"python-boto3",children:"Python boto3"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"import boto3\nfrom botocore.config import Config\n\n# \u521b\u5efa S3 \u5ba2\u6237\u7aef\ns3_client = boto3.client(\n    's3',\n    endpoint_url='http://localhost:9900',\n    aws_access_key_id='AqU4axe4feDyIielarPI',\n    aws_secret_access_key='0CJZ2QfHi2tDb4DKuCJ2vnBEUXg5EYQt',\n    region_name='us-east-1',\n    config=Config(retries={'max_attempts': 3})\n)\n\n# \u521b\u5efa\u5b58\u50a8\u6876\ns3_client.create_bucket(Bucket='my-python-bucket')\n\n# \u4e0a\u4f20\u6587\u4ef6\nwith open('local-file.txt', 'rb') as f:\n    s3_client.put_object(Bucket='my-python-bucket', Key='remote-file.txt', Body=f)\n\n# \u4e0b\u8f7d\u6587\u4ef6\nresponse = s3_client.get_object(Bucket='my-python-bucket', Key='remote-file.txt')\ndata = response['Body'].read()\n\n# \u5217\u51fa\u5bf9\u8c61\nresponse = s3_client.list_objects_v2(Bucket='my-python-bucket')\nfor obj in response.get('Contents', []):\n    print(f\"\u5bf9\u8c61: {obj['Key']}, \u5927\u5c0f: {obj['Size']}\")\n"})}),"\n",(0,l.jsx)(n.h3,{id:"range-\u8bf7\u6c42\u793a\u4f8b",children:"Range \u8bf7\u6c42\u793a\u4f8b"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# \u83b7\u53d6\u6587\u4ef6\u7684\u524d 1000 \u5b57\u8282\ncurl -H "Range: bytes=0-999" \\\n     -H "Authorization: AWS4-HMAC-SHA256 ..." \\\n     http://localhost:9900/my-bucket/large-file.txt\n\n# \u83b7\u53d6\u6587\u4ef6\u7684\u6700\u540e 1000 \u5b57\u8282\ncurl -H "Range: bytes=-1000" \\\n     -H "Authorization: AWS4-HMAC-SHA256 ..." \\\n     http://localhost:9900/my-bucket/large-file.txt\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u591a\u5b9e\u4f8b\u90e8\u7f72",children:"\u591a\u5b9e\u4f8b\u90e8\u7f72"}),"\n",(0,l.jsx)(n.p,{children:"\u4e3a\u4e86\u63d0\u9ad8\u6027\u80fd\u548c\u53ef\u7528\u6027\uff0c\u53ef\u4ee5\u90e8\u7f72\u591a\u4e2a S3 \u7f51\u5173\u5b9e\u4f8b\u3002"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u6ce8\u610f"}),"\uff1a\u76ee\u524d S3 \u7f51\u5173\u91c7\u7528\u4e2d\u5fc3\u5f0f\u90e8\u7f72\u6a21\u5f0f\u3002\u968f Worker \u542f\u52a8\u7684\u975e\u4e2d\u5fc3\u5f0f\u7f51\u5173\u80fd\u529b\u6b63\u5728\u5f00\u53d1\u4e2d\uff0c\u672a\u6765\u5c06\u652f\u6301\u66f4\u52a0\u5206\u5e03\u5f0f\u7684\u90e8\u7f72\u67b6\u6784\u3002"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u8d1f\u8f7d\u5747\u8861\u914d\u7f6e",children:"\u8d1f\u8f7d\u5747\u8861\u914d\u7f6e"}),"\n",(0,l.jsx)(n.h4,{id:"\u4f7f\u7528-nginx",children:"\u4f7f\u7528 Nginx"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-nginx",children:"upstream s3_gateway {\n    server 192.168.1.10:9900 weight=1;\n    server 192.168.1.11:9900 weight=1;\n    server 192.168.1.12:9900 weight=1;\n}\n\nserver {\n    listen 80;\n    server_name s3-gateway.example.com;\n    \n    location / {\n        proxy_pass http://s3_gateway;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        \n        # S3 \u7279\u5b9a\u914d\u7f6e\n        proxy_buffering off;\n        proxy_request_buffering off;\n        client_max_body_size 0;\n    }\n}\n"})}),"\n",(0,l.jsx)(n.h4,{id:"\u4f7f\u7528-haproxy",children:"\u4f7f\u7528 HAProxy"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-haproxy",children:"backend s3_gateway\n    balance roundrobin\n    option httpchk GET /healthz\n    server gateway1 192.168.1.10:9900 check\n    server gateway2 192.168.1.11:9900 check\n    server gateway3 192.168.1.12:9900 check\n\nfrontend s3_frontend\n    bind *:80\n    default_backend s3_gateway\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u591a\u5b9e\u4f8b\u542f\u52a8",children:"\u591a\u5b9e\u4f8b\u542f\u52a8"}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u542f\u52a8\u7f51\u5173\u5b9e\u4f8b\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u8282\u70b9 1\n./build/bin/curvine-s3-gateway.sh start \\\n    --conf /etc/curvine-cluster.toml \\\n    --listen 0.0.0.0:9900\n\n# \u8282\u70b9 2  \n./build/bin/curvine-s3-gateway.sh start \\\n    --conf /etc/curvine-cluster.toml \\\n    --listen 0.0.0.0:9900\n\n# \u8282\u70b9 3\n./build/bin/curvine-s3-gateway.sh start \\\n    --conf /etc/curvine-cluster.toml \\\n    --listen 0.0.0.0:9900\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u9ad8\u53ef\u7528\u914d\u7f6e",children:"\u9ad8\u53ef\u7528\u914d\u7f6e"}),"\n",(0,l.jsx)(n.h4,{id:"\u914d\u7f6e\u5171\u4eab\u5b58\u50a8",children:"\u914d\u7f6e\u5171\u4eab\u5b58\u50a8"}),"\n",(0,l.jsx)(n.p,{children:"\u786e\u4fdd\u6240\u6709\u7f51\u5173\u5b9e\u4f8b\u4f7f\u7528\u76f8\u540c\u7684 Curvine \u96c6\u7fa4\u914d\u7f6e\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:'[s3_gateway]\n# \u4f7f\u7528\u5206\u5e03\u5f0f\u8ba4\u8bc1\u786e\u4fdd\u51ed\u636e\u4e00\u81f4\u6027\nenable_distributed_auth = true\ncredentials_path = "/system/auth/credentials.jsonl"\n\n# \u5171\u4eab\u591a\u90e8\u5206\u4e0a\u4f20\u76ee\u5f55\nmultipart_temp = "/shared/curvine-multipart"\n'})}),"\n",(0,l.jsx)(n.h4,{id:"\u5065\u5eb7\u68c0\u67e5",children:"\u5065\u5eb7\u68c0\u67e5"}),"\n",(0,l.jsx)(n.p,{children:"\u6bcf\u4e2a\u7f51\u5173\u5b9e\u4f8b\u90fd\u63d0\u4f9b\u5065\u5eb7\u68c0\u67e5\u7aef\u70b9\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u68c0\u67e5\u7f51\u5173\u5065\u5eb7\u72b6\u6001\ncurl http://localhost:9900/healthz\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u6027\u80fd\u4f18\u5316",children:"\u6027\u80fd\u4f18\u5316"}),"\n",(0,l.jsx)(n.h4,{id:"\u7cfb\u7edf\u7ea7\u4f18\u5316",children:"\u7cfb\u7edf\u7ea7\u4f18\u5316"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u589e\u52a0\u6587\u4ef6\u63cf\u8ff0\u7b26\u9650\u5236\nulimit -n 65536\n\n# \u4f18\u5316\u7f51\u7edc\u53c2\u6570\necho 'net.ipv4.tcp_keepalive_time = 600' >> /etc/sysctl.conf\necho 'net.core.rmem_max = 16777216' >> /etc/sysctl.conf\necho 'net.core.wmem_max = 16777216' >> /etc/sysctl.conf\nsysctl -p\n"})}),"\n",(0,l.jsx)(n.h4,{id:"\u914d\u7f6e\u8c03\u4f18",children:"\u914d\u7f6e\u8c03\u4f18"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:"[s3_gateway]\n# \u4f18\u5316\u7f13\u5b58\u5237\u65b0\u95f4\u9694\ncache_refresh_interval_secs = 60\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u6545\u969c\u6392\u9664",children:"\u6545\u969c\u6392\u9664"}),"\n",(0,l.jsx)(n.h3,{id:"\u5e38\u89c1\u95ee\u9898",children:"\u5e38\u89c1\u95ee\u9898"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u7aef\u53e3\u88ab\u5360\u7528"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u66f4\u6362\u76d1\u542c\u7aef\u53e3\n./build/bin/curvine-s3-gateway.sh start --listen 0.0.0.0:9901\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u8ba4\u8bc1\u5931\u8d25"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u68c0\u67e5\u73af\u5883\u53d8\u91cf\necho $AWS_ACCESS_KEY_ID\necho $AWS_SECRET_ACCESS_KEY\n\n# \u68c0\u67e5\u51ed\u636e\u5b58\u50a8\u4e2d\u662f\u5426\u5b58\u5728\u76f8\u5e94\u51ed\u636e\n./build/bin/curvine-s3-gateway.sh credential list\n\n# \u67e5\u770b\u51ed\u636e\u5b58\u50a8\u8def\u5f84\u548c\u7edf\u8ba1\u4fe1\u606f\n./build/bin/curvine-s3-gateway.sh credential stats\n\n# \u67e5\u770b\u8ba4\u8bc1\u76f8\u5173\u65e5\u5fd7\nexport RUST_LOG=curvine_s3_gateway::auth=debug\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u914d\u7f6e\u6587\u4ef6\u9519\u8bef"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u9a8c\u8bc1\u914d\u7f6e\u6587\u4ef6\n./build/bin/curvine-s3-gateway.sh start --conf /path/to/config.toml\n\n# \u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\n./build/bin/curvine-s3-gateway.sh start\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u8c03\u8bd5\u6a21\u5f0f",children:"\u8c03\u8bd5\u6a21\u5f0f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u542f\u7528\u8be6\u7ec6\u65e5\u5fd7\nexport RUST_LOG=debug\n./build/bin/curvine-s3-gateway.sh start\n\n# \u542f\u7528\u8ddf\u8e2a\u7ea7\u522b\u65e5\u5fd7\nexport RUST_LOG=trace\n./build/bin/curvine-s3-gateway.sh start\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u901a\u8fc7\u4ee5\u4e0a\u914d\u7f6e\u548c\u4f18\u5316\uff0c\u60a8\u53ef\u4ee5\u6784\u5efa S3 \u7f51\u5173\u9ad8\u6548\u7684\u8bbf\u95ee\u7f13\u5b58\u5728 Curvine \u4e2d\u7684\u6570\u636e\u3002"})]})}function x(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},8388:(e,n,s)=>{s.d(n,{A:()=>i});const i="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDYwMCAyMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPCEtLSBCYWNrZ3JvdW5kIC0tPgogIDxyZWN0IHdpZHRoPSI2MDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjZjhmOWZhIiBzdHJva2U9Im5vbmUiLz4KICAKICA8IS0tIFMzIENsaWVudCAtLT4KICA8cmVjdCB4PSIyMCIgeT0iNjAiIHdpZHRoPSIxMjAiIGhlaWdodD0iODAiIHJ4PSI4IiBmaWxsPSIjZTNmMmZkIiBzdHJva2U9IiMxOTc2ZDIiIHN0cm9rZS13aWR0aD0iMiIvPgogIDx0ZXh0IHg9IjgwIiB5PSI4NSIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0iIzE5NzZkMiIgdGV4dC1hbmNob3I9Im1pZGRsZSI+UzMg5a6i5oi356uvPC90ZXh0PgogIDx0ZXh0IHg9IjgwIiB5PSIxMDUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMCIgZmlsbD0iIzE5NzZkMiIgdGV4dC1hbmNob3I9Im1pZGRsZSI+KEFXUyBDTEnnrYkpPC90ZXh0PgogIAogIDwhLS0gUzMgR2F0ZXdheSAtLT4KICA8cmVjdCB4PSIyMjAiIHk9IjYwIiB3aWR0aD0iMTYwIiBoZWlnaHQ9IjgwIiByeD0iOCIgZmlsbD0iI2U4ZjVlOCIgc3Ryb2tlPSIjMzg4ZTNjIiBzdHJva2Utd2lkdGg9IjIiLz4KICA8dGV4dCB4PSIzMDAiIHk9Ijg1IiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSIjMzg4ZTNjIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5TMyBHYXRld2F5PC90ZXh0PgogIDx0ZXh0IHg9IjMwMCIgeT0iMTA1IiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IiMzODhlM2MiIHRleHQtYW5jaG9yPSJtaWRkbGUiPijnvZHlhbPmnI3liqEpPC90ZXh0PgogIAogIDwhLS0gQ3VydmluZSBVRlMgLS0+CiAgPHJlY3QgeD0iNDYwIiB5PSI2MCIgd2lkdGg9IjEyMCIgaGVpZ2h0PSI4MCIgcng9IjgiIGZpbGw9IiNmZmYzZTAiIHN0cm9rZT0iI2Y1N2MwMCIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgPHRleHQgeD0iNTIwIiB5PSI4NSIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0iI2Y1N2MwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+Q3VydmluZSBVRlM8L3RleHQ+CiAgPHRleHQgeD0iNTIwIiB5PSIxMDUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMCIgZmlsbD0iI2Y1N2MwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+KOWIhuW4g+W8j+WtmOWCqCk8L3RleHQ+CiAgCiAgPCEtLSBBcnJvd3Mgd2l0aCBsYWJlbHMgLS0+CiAgPCEtLSBTMyBBUEkgYXJyb3cgLS0+CiAgPHBhdGggZD0iTSAxNDAgMTAwIEwgMjIwIDEwMCIgc3Ryb2tlPSIjMmMzZTUwIiBzdHJva2Utd2lkdGg9IjIiIG1hcmtlci1lbmQ9InVybCgjYXJyb3cpIi8+CiAgPHRleHQgeD0iMTgwIiB5PSI5NSIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjEwIiBmaWxsPSIjMmMzZTUwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5TMyBBUEk8L3RleHQ+CiAgCiAgPCEtLSBVRlMgQVBJIGFycm93IC0tPgogIDxwYXRoIGQ9Ik0gMzgwIDEwMCBMIDQ2MCAxMDAiIHN0cm9rZT0iIzJjM2U1MCIgc3Ryb2tlLXdpZHRoPSIyIiBtYXJrZXItZW5kPSJ1cmwoI2Fycm93KSIvPgogIDx0ZXh0IHg9IjQyMCIgeT0iOTUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMCIgZmlsbD0iIzJjM2U1MCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+VUZTIEFQSTwvdGV4dD4KICAKICA8IS0tIEFycm93IG1hcmtlciAtLT4KICA8ZGVmcz4KICAgIDxtYXJrZXIgaWQ9ImFycm93IiBtYXJrZXJXaWR0aD0iMTAiIG1hcmtlckhlaWdodD0iMTAiIHJlZlg9IjkiIHJlZlk9IjMiIG9yaWVudD0iYXV0byIgbWFya2VyVW5pdHM9InN0cm9rZVdpZHRoIj4KICAgICAgPHBvbHlnb24gcG9pbnRzPSIwLDAgMCw2IDksMyIgZmlsbD0iIzJjM2U1MCIvPgogICAgPC9tYXJrZXI+CiAgPC9kZWZzPgo8L3N2Zz4K"},8453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>r});var i=s(6540);const l={},c=i.createContext(l);function d(e){const n=i.useContext(c);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:d(e.components),i.createElement(c.Provider,{value:n},e.children)}}}]);