"use strict";(self.webpackChunkcurvine_doc=self.webpackChunkcurvine_doc||[]).push([[6165],{7875:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"User-Manuals/csi","title":"K8S CSI Driver","description":"To facilitate quick integration with Curvine in cloud-native environments, Curvine provides CSI driver support. Your Pod containers can access Curvine through PV (Persistent Volume) without requiring application modifications, enabling seamless use of Curvine\'s caching capabilities.","source":"@site/docs/3-User-Manuals/07-csi.md","sourceDirName":"3-User-Manuals","slug":"/User-Manuals/csi","permalink":"/docs/User-Manuals/csi","draft":false,"unlisted":false,"editUrl":"https://github.com/curvineio/curvine-doc/edit/main/docs/3-User-Manuals/07-csi.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Configuration Reference","permalink":"/docs/User-Manuals/conf"},"next":{"title":"Fuse Mode Access","permalink":"/docs/User-Manuals/fuse"}}');var s=i(4848),t=i(8453);const d={},l="K8S CSI Driver",c={},a=[{value:"Architecture Overview",id:"architecture-overview",level:2},{value:"Core Components",id:"core-components",level:3},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Environment Requirements",id:"environment-requirements",level:3},{value:"Environment Check",id:"environment-check",level:3},{value:"I. Installing Curvine CSI",id:"i-installing-curvine-csi",level:2},{value:"1.1 Get Helm Chart",id:"11-get-helm-chart",level:3},{value:"1.2 Configure Custom Parameters (Optional)",id:"12-configure-custom-parameters-optional",level:3},{value:"1.4 Upgrade and Uninstall",id:"14-upgrade-and-uninstall",level:3},{value:"II. Verification and Status Check",id:"ii-verification-and-status-check",level:2},{value:"2.1 Check CSI Driver Registration",id:"21-check-csi-driver-registration",level:3},{value:"2.2 Check Controller Status",id:"22-check-controller-status",level:3},{value:"2.3 Check Node Plugin Status",id:"23-check-node-plugin-status",level:3},{value:"III. StorageClass Explained",id:"iii-storageclass-explained",level:2},{value:"3.1 StorageClass Configuration Example",id:"31-storageclass-configuration-example",level:3},{value:"3.2 Parameter Details",id:"32-parameter-details",level:3},{value:"Core Parameters",id:"core-parameters",level:4},{value:"Path Creation Strategy (path-type)",id:"path-creation-strategy-path-type",level:4},{value:"Reclaim Policy (reclaimPolicy)",id:"reclaim-policy-reclaimpolicy",level:4},{value:"Binding Mode (volumeBindingMode)",id:"binding-mode-volumebindingmode",level:4},{value:"3.3 Dynamic PV Path Generation Rules",id:"33-dynamic-pv-path-generation-rules",level:3},{value:"3.4 Create StorageClass",id:"34-create-storageclass",level:3},{value:"3.5 Multiple StorageClass Scenarios",id:"35-multiple-storageclass-scenarios",level:3},{value:"IV. Static PV Usage",id:"iv-static-pv-usage",level:2},{value:"4.1 Working Principle",id:"41-working-principle",level:3},{value:"4.2 Create Static PV",id:"42-create-static-pv",level:3},{value:"4.3 Create Static PVC",id:"43-create-static-pvc",level:3},{value:"4.4 Verify Binding",id:"44-verify-binding",level:3},{value:"4.5 Using Static PV in Pod",id:"45-using-static-pv-in-pod",level:3},{value:"V. Dynamic PV Usage",id:"v-dynamic-pv-usage",level:2},{value:"5.1 Working Principle",id:"51-working-principle",level:3},{value:"5.2 Create Dynamic PVC",id:"52-create-dynamic-pvc",level:3},{value:"5.3 Automatic Path Generation Example",id:"53-automatic-path-generation-example",level:3},{value:"5.4 Dynamic PV Complete Example",id:"54-dynamic-pv-complete-example",level:3},{value:"VI. Using Dynamic PV in Deployment",id:"vi-using-dynamic-pv-in-deployment",level:2},{value:"6.1 Architecture Pattern",id:"61-architecture-pattern",level:3},{value:"6.2 Complete Example",id:"62-complete-example",level:3},{value:"6.3 Deploy and Verify",id:"63-deploy-and-verify",level:3},{value:"VII. Using Dynamic PV in StatefulSet",id:"vii-using-dynamic-pv-in-statefulset",level:2},{value:"7.1 Architecture Pattern",id:"71-architecture-pattern",level:3},{value:"7.2 Complete Example",id:"72-complete-example",level:3},{value:"7.3 Deploy and Verify",id:"73-deploy-and-verify",level:3},{value:"7.4 StatefulSet Features",id:"74-statefulset-features",level:3},{value:"PVC Naming Convention",id:"pvc-naming-convention",level:4},{value:"Pod and PVC Lifecycle",id:"pod-and-pvc-lifecycle",level:4},{value:"Scaling",id:"scaling",level:4},{value:"FUSE Process Sharing",id:"fuse-process-sharing",level:4},{value:"Appendix",id:"appendix",level:2},{value:"Helm Custom Parameters",id:"helm-custom-parameters",level:3},{value:"Global Settings",id:"global-settings",level:4},{value:"Image Settings",id:"image-settings",level:4},{value:"CSI Driver Settings",id:"csi-driver-settings",level:4},{value:"Controller Settings",id:"controller-settings",level:4},{value:"Controller Sidecar Container Configuration",id:"controller-sidecar-container-configuration",level:4},{value:"Node Settings",id:"node-settings",level:4},{value:"Node Sidecar Container Configuration",id:"node-sidecar-container-configuration",level:4},{value:"Node Host Path Configuration",id:"node-host-path-configuration",level:4},{value:"Service Account Settings",id:"service-account-settings",level:4},{value:"RBAC Configuration",id:"rbac-configuration",level:4},{value:"ConfigMap Configuration (Curvine Cluster Configuration)",id:"configmap-configuration-curvine-cluster-configuration",level:4},{value:"Curvine Cluster Configuration Parameters in ConfigMap",id:"curvine-cluster-configuration-parameters-in-configmap",level:4},{value:"StorageClass Parameters (Configured at Usage Time)",id:"storageclass-parameters-configured-at-usage-time",level:4}];function o(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"k8s-csi-driver",children:"K8S CSI Driver"})}),"\n",(0,s.jsxs)(n.p,{children:["To facilitate quick integration with Curvine in cloud-native environments, Curvine provides CSI driver support. Your Pod containers can access Curvine through ",(0,s.jsx)(n.code,{children:"PV"})," (Persistent Volume) without requiring application modifications, enabling seamless use of Curvine's caching capabilities."]}),"\n",(0,s.jsx)(n.p,{children:"The Curvine CSI driver follows the standard CSI specification and includes:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"CSI Controller"}),", deployed in ",(0,s.jsx)(n.code,{children:"Deployment"})," or ",(0,s.jsx)(n.code,{children:"Statefulset"})," mode"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"CSI Node Plugin"}),", deployed in ",(0,s.jsx)(n.code,{children:"DaemonSet"})," mode"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"architecture-overview",children:"Architecture Overview"}),"\n",(0,s.jsx)(n.p,{children:"The Curvine CSI driver adopts the standard CSI architecture with two main components:"}),"\n",(0,s.jsx)(n.mermaid,{value:'---\nconfig:\n  theme: \'base\'\n---\n\ngraph TB\n    subgraph "Kubernetes Cluster"\n        subgraph "Control Plane"\n            Controller[CSI Controller<br/>Deployment]\n            Provisioner[csi-provisioner]\n            Attacher[csi-attacher]\n            Controller --\x3e Provisioner\n            Controller --\x3e Attacher\n        end\n        \n        subgraph "Worker Nodes"\n            Node1[CSI Node Plugin<br/>DaemonSet]\n            Node2[CSI Node Plugin<br/>DaemonSet]\n            Registrar1[node-driver-registrar]\n            Registrar2[node-driver-registrar]\n            Node1 --\x3e Registrar1\n            Node2 --\x3e Registrar2\n        end\n        \n        Pod1[Application Pod]\n        Pod2[Application Pod]\n        \n        Pod1 -.Mount.-> Node1\n        Pod2 -.Mount.-> Node2\n    end\n    \n    subgraph "Curvine Cluster"\n        Master[Master Nodes<br/>8995]\n        Storage[Storage Nodes]\n        Master --\x3e Storage\n    end\n    \n    Node1 -.FUSE Mount.-> Master\n    Node2 -.FUSE Mount.-> Master'}),"\n",(0,s.jsx)(n.h3,{id:"core-components",children:"Core Components"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"CSI Controller"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Runs in the Control Plane"}),"\n",(0,s.jsx)(n.li,{children:"Responsible for Volume creation, deletion, Attach/Detach operations"}),"\n",(0,s.jsx)(n.li,{children:"Includes csi-provisioner and csi-attacher sidecars"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"CSI Node Plugin"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Runs as DaemonSet on each Worker Node"}),"\n",(0,s.jsx)(n.li,{children:"Responsible for mounting Curvine storage to Pods"}),"\n",(0,s.jsx)(n.li,{children:"Uses FUSE technology for filesystem mounting"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"FUSE Mounting Mechanism"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Directly mounts Curvine filesystem paths"}),"\n",(0,s.jsx)(n.li,{children:"Same paths share FUSE process, saving resources"}),"\n",(0,s.jsx)(n.li,{children:"Supports concurrent access by multiple Pods"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsx)(n.h3,{id:"environment-requirements",children:"Environment Requirements"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Kubernetes 1.19+"}),"\n",(0,s.jsx)(n.li,{children:"Helm 3.0+"}),"\n",(0,s.jsx)(n.li,{children:"Accessible Curvine cluster (Master node address and port)"}),"\n",(0,s.jsx)(n.li,{children:"Cluster administrator privileges"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"environment-check",children:"Environment Check"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check Kubernetes version\nkubectl version --short\n\n# Check Helm version\nhelm version --short\n\n# Check node status\nkubectl get nodes\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"i-installing-curvine-csi",children:"I. Installing Curvine CSI"}),"\n",(0,s.jsx)(n.h3,{id:"11-get-helm-chart",children:"1.1 Get Helm Chart"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"helm repo add curvine https://curvineio.github.io/helm-charts\nhelm repo update\nhelm search repo curvine --devel\nhelm install curvine-csi curvine/curvine-csi \\ \n    --namespace curvine-system \\ \n    --create-namespace --devel \\ \n    --version 0.0.1-dev+7ffc6a2\n"})}),"\n",(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsx)(n.p,{children:"The current Curvine Helm repository provides pre-release versions:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Use ",(0,s.jsx)(n.code,{children:"--devel"})," to view them, and replace the ",(0,s.jsx)(n.code,{children:"--version"})," in the command above with your desired version"]}),"\n",(0,s.jsxs)(n.li,{children:["curvine-csi is installed by default in the ",(0,s.jsx)(n.code,{children:"curvine-system"})," namespace via Helm"]}),"\n",(0,s.jsx)(n.li,{children:"Official release versions will be provided progressively"}),"\n"]})]}),"\n",(0,s.jsx)(n.h3,{id:"12-configure-custom-parameters-optional",children:"1.2 Configure Custom Parameters (Optional)"}),"\n",(0,s.jsx)(n.p,{children:"curvine-csi supports rich customization parameters. If your network environment has restrictions, you can use custom images and other methods."}),"\n",(0,s.jsxs)(n.p,{children:["For example, create a ",(0,s.jsx)(n.code,{children:"custom-values.yaml"})," file:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Image configuration\nimage:\n  repository: ghcr.io/curvineio/curvine-csi\n  tag: latest\n  pullPolicy: IfNotPresent\n\n# Controller configuration\ncontroller:\n  replicas: 1\n  resources:\n    requests:\n      cpu: 100m\n      memory: 128Mi\n    limits:\n      cpu: 500m\n      memory: 512Mi\n\n# Node configuration\nnode:\n  resources:\n    requests:\n      cpu: 100m\n      memory: 128Mi\n    limits:\n      cpu: 500m\n      memory: 512Mi\n"})}),"\n",(0,s.jsx)(n.p,{children:"Install with custom parameters using Helm:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"helm install curvine-csi curvine/curvine-csi \\ \n    --namespace curvine-system \\ \n    --create-namespace --devel \\ \n  --values custom-values.yaml\n\n# Check installation status\nhelm status curvine-csi -n curvine-system\n"})}),"\n",(0,s.jsx)(n.h3,{id:"14-upgrade-and-uninstall",children:"1.4 Upgrade and Uninstall"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Upgrade\nhelm upgrade curvine curvine/curvine-csi -n curvine-system --devel --version xxxxx\n\n# Uninstall\nhelm uninstall curvine-csi -n curvine-system\n\n# Complete cleanup (including namespace)\nkubectl delete namespace curvine-system\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"ii-verification-and-status-check",children:"II. Verification and Status Check"}),"\n",(0,s.jsx)(n.h3,{id:"21-check-csi-driver-registration",children:"2.1 Check CSI Driver Registration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check if CSI Driver is registered successfully\nkubectl get csidriver curvine\n\n# Example output:\n# NAME      ATTACHREQUIRED   PODINFOONMOUNT   STORAGECAPACITY\n# curvine   false            false            false\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameter Explanation:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ATTACHREQUIRED: false"})," - No Attach operation needed (direct FUSE mount)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"PODINFOONMOUNT: false"})," - No Pod information needed during mount"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"22-check-controller-status",children:"2.2 Check Controller Status"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check Controller Deployment\nkubectl get deployment -n curvine-system curvine-csi-controller\n\n# Check Controller Pod\nkubectl get pods -n curvine-system -l app=curvine-csi-controller\n\n# Check Controller logs\nkubectl logs -n curvine-system \\\n  -l app=curvine-csi-controller \\\n  -c csi-plugin \\\n  --tail=50\n\n# Check Provisioner Sidecar logs\nkubectl logs -n curvine-system \\\n  -l app=curvine-csi-controller \\\n  -c csi-provisioner \\\n  --tail=50\n"})}),"\n",(0,s.jsx)(n.h3,{id:"23-check-node-plugin-status",children:"2.3 Check Node Plugin Status"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check Node DaemonSet\nkubectl get daemonset -n curvine-system curvine-csi-node\n\n# Check all Node Plugin Pods\nkubectl get pods -n curvine-system -l app=curvine-csi-node -o wide\n\n# Check specific Node logs\nkubectl logs -n curvine-system curvine-csi-node-xxxxx -c csi-plugin\n\n# Check Node Registrar logs\nkubectl logs -n curvine-system curvine-csi-node-xxxxx -c node-driver-registrar\n"})}),"\n",(0,s.jsx)(n.h2,{id:"iii-storageclass-explained",children:"III. StorageClass Explained"}),"\n",(0,s.jsx)(n.p,{children:"StorageClass is a resource in Kubernetes that defines storage types, used for automatic creation of dynamic PVs."}),"\n",(0,s.jsx)(n.h3,{id:"31-storageclass-configuration-example",children:"3.1 StorageClass Configuration Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: curvine-sc\nprovisioner: curvine                      # CSI driver name\nreclaimPolicy: Delete                     # Reclaim policy\nvolumeBindingMode: Immediate              # Binding mode\nallowVolumeExpansion: true                # Allow expansion\nparameters:\n  # Required: Curvine cluster connection information\n  master-addrs: "master1:8995,master2:8995,master3:8995"\n  \n  # Required: Filesystem path prefix\n  fs-path: "/k8s-volumes"\n  \n  # Optional: Path creation strategy\n  path-type: "DirectoryOrCreate"\n  \n  # Optional: FUSE parameters\n  io-threads: "4"\n  worker-threads: "8"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"32-parameter-details",children:"3.2 Parameter Details"}),"\n",(0,s.jsx)(n.h4,{id:"core-parameters",children:"Core Parameters"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter"}),(0,s.jsx)(n.th,{children:"Required"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Example"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"master-addrs"})}),(0,s.jsx)(n.td,{children:"\u2705"}),(0,s.jsx)(n.td,{children:"Curvine Master node address list, comma-separated"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'"10.0.0.1:8995,10.0.0.2:8995"'})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"fs-path"})}),(0,s.jsx)(n.td,{children:"\u2705"}),(0,s.jsxs)(n.td,{children:["Path prefix for dynamic PVs, actual path is ",(0,s.jsx)(n.code,{children:"fs-path + pv-name"})]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'"/k8s-volumes"'})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"path-type"})}),(0,s.jsx)(n.td,{children:"\u274c"}),(0,s.jsxs)(n.td,{children:["Path creation strategy, defaults to ",(0,s.jsx)(n.code,{children:"Directory"})]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'"DirectoryOrCreate"'})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"io-threads"})}),(0,s.jsx)(n.td,{children:"\u274c"}),(0,s.jsx)(n.td,{children:"FUSE IO thread count"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'"4"'})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"worker-threads"})}),(0,s.jsx)(n.td,{children:"\u274c"}),(0,s.jsx)(n.td,{children:"FUSE worker thread count"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'"8"'})})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"path-creation-strategy-path-type",children:"Path Creation Strategy (path-type)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Directory"})})," (default)"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Path must already exist"}),"\n",(0,s.jsx)(n.li,{children:"Recommended for production environments"}),"\n",(0,s.jsx)(n.li,{children:"Ensures path is pre-created by administrators"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"DirectoryOrCreate"})})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Automatically creates path if it doesn't exist"}),"\n",(0,s.jsx)(n.li,{children:"Suitable for testing and development environments"}),"\n",(0,s.jsx)(n.li,{children:"Note permission issues"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"reclaim-policy-reclaimpolicy",children:"Reclaim Policy (reclaimPolicy)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Delete"})})," (recommended for dynamic PVs)"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Automatically deletes PV and storage data when PVC is deleted"}),"\n",(0,s.jsx)(n.li,{children:"Suitable for temporary data and testing environments"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Retain"})})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"PV is retained after PVC deletion"}),"\n",(0,s.jsx)(n.li,{children:"Data needs manual cleanup"}),"\n",(0,s.jsx)(n.li,{children:"Suitable for important data protection"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"binding-mode-volumebindingmode",children:"Binding Mode (volumeBindingMode)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Immediate"})})," (default)"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"PV is bound immediately after PVC creation"}),"\n",(0,s.jsx)(n.li,{children:"Suitable for single AZ clusters"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"WaitForFirstConsumer"})})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Waits for Pod scheduling before binding PV"}),"\n",(0,s.jsx)(n.li,{children:"Suitable for multi-AZ clusters, ensures PV is available on the Pod's node"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"33-dynamic-pv-path-generation-rules",children:"3.3 Dynamic PV Path Generation Rules"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'Actual mount path = fs-path + "/" + pv-name\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# StorageClass configuration\nfs-path: "/k8s-volumes"\n\n# Auto-generated PV name\npv-name: "pvc-1234-5678-abcd"\n\n# Final Curvine path\nActual path: "/k8s-volumes/pvc-1234-5678-abcd"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"34-create-storageclass",children:"3.4 Create StorageClass"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Create StorageClass\nkubectl apply -f - <<EOF\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: curvine-sc\nprovisioner: curvine\nreclaimPolicy: Delete\nvolumeBindingMode: Immediate\nallowVolumeExpansion: true\nparameters:\n  master-addrs: "m0:8995,m1:8995,m2:8995"\n  fs-path: "/k8s-volumes"\n  path-type: "DirectoryOrCreate"\nEOF\n\n# View StorageClass\nkubectl get storageclass curvine-sc\n\n# Set as default StorageClass (optional)\nkubectl patch storageclass curvine-sc \\\n  -p \'{"metadata": {"annotations":{"storageclass.kubernetes.io/is-default-class":"true"}}}\'\n'})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["Replace the ",(0,s.jsx)(n.code,{children:"master-addrs"})," in the example above with your actual master addresses."]})}),"\n",(0,s.jsx)(n.h3,{id:"35-multiple-storageclass-scenarios",children:"3.5 Multiple StorageClass Scenarios"}),"\n",(0,s.jsx)(n.p,{children:"You can create multiple StorageClasses for different scenarios:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# Production environment - strict mode\n---\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: curvine-prod\nprovisioner: curvine\nreclaimPolicy: Retain\nvolumeBindingMode: WaitForFirstConsumer\nparameters:\n  master-addrs: "prod-master1:8995,prod-master2:8995"\n  fs-path: "/production"\n  path-type: "Directory"\n\n# Development environment - relaxed mode\n---\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: curvine-dev\nprovisioner: curvine\nreclaimPolicy: Delete\nvolumeBindingMode: Immediate\nparameters:\n  master-addrs: "dev-master:8995"\n  fs-path: "/development"\n  path-type: "DirectoryOrCreate"\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"iv-static-pv-usage",children:"IV. Static PV Usage"}),"\n",(0,s.jsx)(n.p,{children:"Static PV is used to mount existing data directories in Curvine, suitable for the following scenarios:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Multiple clusters sharing the same data"}),"\n",(0,s.jsx)(n.li,{children:"Need for precise control over data paths"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"41-working-principle",children:"4.1 Working Principle"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Curvine cluster has existing data\n    \u2193\nAdministrator creates PV, specifying curvine-path\n    \u2193\nUser creates PVC, binds to specified PV\n    \u2193\nPod mounts PVC\n"})}),"\n",(0,s.jsx)(n.h3,{id:"42-create-static-pv",children:"4.2 Create Static PV"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: curvine-pv-existing-data\n  labels:\n    type: curvine-static\nspec:\n  storageClassName: curvine-sc\n  capacity:\n    storage: 100Gi                    # Declared capacity\n  accessModes:\n    - ReadWriteMany                   # Supports multi-Pod read-write\n  persistentVolumeReclaimPolicy: Retain  # Retain data\n  csi:\n    driver: curvine\n    volumeHandle: "existing-data-volume-001"  # Unique identifier\n    volumeAttributes:\n      # Required: Curvine Master address\n      master-addrs: "m0:8995,m1:8995,m2:8995"\n      \n      # Required: Complete path in Curvine\n      curvine-path: "/production/user-data"\n      \n      # Recommended: Use Directory to ensure path exists\n      path-type: "Directory"\n      \n      # Optional: FUSE parameters\n      io-threads: "4"\n      worker-threads: "8"\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameter Explanation:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"volumeHandle"}),": Any unique string, used to identify the PV"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"curvine-path"}),": Complete path in Curvine filesystem, must already exist"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"path-type: Directory"}),": Requires path to exist (recommended)"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"43-create-static-pvc",children:"4.3 Create Static PVC"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: curvine-pvc-existing-data\n  namespace: default\nspec:\n  storageClassName: curvine-sc\n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 100Gi\n  # Key: Specify the PV name to bind\n  volumeName: curvine-pv-existing-data\n"})}),"\n",(0,s.jsx)(n.h3,{id:"44-verify-binding",children:"4.4 Verify Binding"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check PV status\nkubectl get pv curvine-pv-existing-data\n# STATUS should be Bound\n\n# Check PVC status\nkubectl get pvc curvine-pvc-existing-data\n# STATUS should be Bound\n\n# Check detailed information\nkubectl describe pvc curvine-pvc-existing-data\n"})}),"\n",(0,s.jsx)(n.h3,{id:"45-using-static-pv-in-pod",children:"4.5 Using Static PV in Pod"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Pod\nmetadata:\n  name: static-pv-test\nspec:\n  containers:\n  - name: app\n    image: nginx:alpine\n    volumeMounts:\n    - name: data\n      mountPath: /data\n  volumes:\n  - name: data\n    persistentVolumeClaim:\n      claimName: curvine-pvc-existing-data\n"})}),"\n",(0,s.jsx)(n.h2,{id:"v-dynamic-pv-usage",children:"V. Dynamic PV Usage"}),"\n",(0,s.jsx)(n.p,{children:"Dynamic PV is the most commonly used method, automatically created and managed by the CSI Controller."}),"\n",(0,s.jsx)(n.h3,{id:"51-working-principle",children:"5.1 Working Principle"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"User creates PVC, specifying StorageClass\n    \u2193\nCSI Provisioner automatically creates PV\n    \u2193\nAuto-generates Curvine path: fs-path + pv-name\n    \u2193\nPVC automatically binds to PV\n    \u2193\nPod mounts PVC for use\n"})}),"\n",(0,s.jsx)(n.h3,{id:"52-create-dynamic-pvc",children:"5.2 Create Dynamic PVC"}),"\n",(0,s.jsx)(n.p,{children:"Dynamic PVC requires specifying a storageclass, without specifying volumeName:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: my-dynamic-pvc\n  namespace: default\nspec:\n  storageClassName: curvine-sc    # Specify StorageClass\n  accessModes:\n    - ReadWriteOnce               # or ReadWriteMany\n  resources:\n    requests:\n      storage: 10Gi               # Request capacity\n"})}),"\n",(0,s.jsx)(n.h3,{id:"53-automatic-path-generation-example",children:"5.3 Automatic Path Generation Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# StorageClass configuration\nfs-path: "/k8s-volumes"\n\n# PVC name\nname: my-dynamic-pvc\n\n# Auto-generated PV\n# volumeHandle: pvc-1a2b3c4d-5e6f-7g8h-9i0j-k1l2m3n4o5p6\n\n# Actual Curvine path\n# /k8s-volumes/pvc-1a2b3c4d-5e6f-7g8h-9i0j-k1l2m3n4o5p6\n\n# You can use Curvine\'s cv command to check if the volume was created correctly in the Curvine cluster\n./bin/cv fs ls /\n'})}),"\n",(0,s.jsx)(n.h3,{id:"54-dynamic-pv-complete-example",children:"5.4 Dynamic PV Complete Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# 1. Create dynamic PVC\nkubectl apply -f - <<EOF\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: app-data-pvc\n  namespace: default\nspec:\n  storageClassName: curvine-sc\n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 20Gi\nEOF\n\n# 2. Check PVC status (should automatically Bound)\nkubectl get pvc app-data-pvc\nkubectl describe pvc app-data-pvc\n\n# 3. Check auto-created PV\nkubectl get pv\n\n# 4. Create Pod using PVC\nkubectl apply -f - <<EOF\napiVersion: v1\nkind: Pod\nmetadata:\n  name: dynamic-pv-test\nspec:\n  containers:\n  - name: app\n    image: nginx:alpine\n    volumeMounts:\n    - name: data\n      mountPath: /usr/share/nginx/html\n  volumes:\n  - name: data\n    persistentVolumeClaim:\n      claimName: app-data-pvc\nEOF\n\n# 5. Test write and read\nkubectl exec dynamic-pv-test -- sh -c 'echo \"Hello Curvine\" > /usr/share/nginx/html/index.html'\nkubectl exec dynamic-pv-test -- cat /usr/share/nginx/html/index.html\n"})}),"\n",(0,s.jsx)(n.h2,{id:"vi-using-dynamic-pv-in-deployment",children:"VI. Using Dynamic PV in Deployment"}),"\n",(0,s.jsx)(n.p,{children:"Deployment is suitable for stateless applications where multiple replicas share the same storage."}),"\n",(0,s.jsx)(n.h3,{id:"61-architecture-pattern",children:"6.1 Architecture Pattern"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"           Deployment (3 replicas)\n               /      |      \\\n            Pod-1  Pod-2  Pod-3\n               \\      |      /\n                Single PVC (RWX)\n                      |\n              Curvine Volume (Shared)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"62-complete-example",children:"6.2 Complete Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# deployment-with-pvc.yaml\n---\n# 1. Create shared PVC\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: shared-data-pvc\n  namespace: default\nspec:\n  storageClassName: curvine-sc\n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 10Gi\n\n---\n# 2. Create Deployment\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web-app\n  namespace: default\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web-app\n  template:\n    metadata:\n      labels:\n        app: web-app\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:alpine\n        ports:\n        - containerPort: 80\n        volumeMounts:\n        - name: shared-storage\n          mountPath: /usr/share/nginx/html\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 80\n          initialDelaySeconds: 10\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 80\n          initialDelaySeconds: 5\n      volumes:\n      - name: shared-storage\n        persistentVolumeClaim:\n          claimName: shared-data-pvc  # Share the same PVC\n\n---\n# 3. Create Service\napiVersion: v1\nkind: Service\nmetadata:\n  name: web-app-service\n  namespace: default\nspec:\n  selector:\n    app: web-app\n  ports:\n  - port: 80\n    targetPort: 80\n  type: ClusterIP\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["For Deployment applications, Kubernetes is natively positioned for stateless services, meaning all replica Pods by default read and write to the same PV path. If your application requires different path isolation on Curvine, you can try using OpenKruise's ",(0,s.jsx)(n.code,{children:"CloneSets"})," as an alternative, which supports VolumeClaimTemplates. Reference: ",(0,s.jsx)(n.a,{href:"https://openkruise.io/zh/docs/user-manuals/cloneset",children:"https://openkruise.io/zh/docs/user-manuals/cloneset"})]})}),"\n",(0,s.jsx)(n.h3,{id:"63-deploy-and-verify",children:"6.3 Deploy and Verify"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# 1. Deploy application\nkubectl apply -f deployment-with-pvc.yaml\n\n# 2. Check PVC status\nkubectl get pvc shared-data-pvc\n\n# 3. Check all Pods\nkubectl get pods -l app=web-app -o wide\n\n# 4. Verify all Pods mounted the same PVC\nkubectl get pods -l app=web-app -o jsonpath='{range .items[*]}{.metadata.name}{\"\\t\"}{.spec.volumes[0].persistentVolumeClaim.claimName}{\"\\n\"}{end}'\n\n# 5. Write data in one Pod\nPOD1=$(kubectl get pod -l app=web-app -o jsonpath='{.items[0].metadata.name}')\nkubectl exec $POD1 -- sh -c 'echo \"Hello from Pod 1\" > /usr/share/nginx/html/test.html'\n\n# 6. Read data in another Pod (verify sharing)\nPOD2=$(kubectl get pod -l app=web-app -o jsonpath='{.items[1].metadata.name}')\nkubectl exec $POD2 -- cat /usr/share/nginx/html/test.html\n# Should output: Hello from Pod 1\n\n# 7. Verify Service access\nkubectl run curl-test --image=curlimages/curl --rm -it --restart=Never -- curl http://web-app-service/test.html\n"})}),"\n",(0,s.jsx)(n.h2,{id:"vii-using-dynamic-pv-in-statefulset",children:"VII. Using Dynamic PV in StatefulSet"}),"\n",(0,s.jsx)(n.p,{children:"StatefulSet is suitable for stateful applications, where each Pod has independent persistent storage."}),"\n",(0,s.jsx)(n.h3,{id:"71-architecture-pattern",children:"7.1 Architecture Pattern"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"        StatefulSet (3 replicas)\n            |         |         |\n         Pod-0     Pod-1     Pod-2\n            |         |         |\n         PVC-0     PVC-1     PVC-2\n            |         |         |\n          PV-0      PV-1      PV-2\n            |         |         |\n     /path/pvc-0  /path/pvc-1  /path/pvc-2\n"})}),"\n",(0,s.jsx)(n.h3,{id:"72-complete-example",children:"7.2 Complete Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# statefulset-web-app.yaml\n---\n# 1. Headless Service (required)\napiVersion: v1\nkind: Service\nmetadata:\n  name: web-app-service\n  namespace: default\nspec:\n  clusterIP: None                # Headless Service\n  selector:\n    app: web-app\n  ports:\n  - port: 80\n    name: web\n\n---\n# 2. StatefulSet with VolumeClaimTemplates\napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: web-app\n  namespace: default\nspec:\n  serviceName: web-app-service   # Must specify Service\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web-app\n  template:\n    metadata:\n      labels:\n        app: web-app\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:alpine\n        ports:\n        - containerPort: 80\n          name: web\n        volumeMounts:\n        - name: data                # Must match volumeClaimTemplates name\n          mountPath: /usr/share/nginx/html\n        command:\n        - /bin/sh\n        - -c\n        - |\n          # Write hello world message with pod name\n          echo "<h1>Hello from $(hostname)</h1>" > /usr/share/nginx/html/index.html\n          echo "<p>This is my persistent storage!</p>" >> /usr/share/nginx/html/index.html\n          echo "<p>Created at: $(date)</p>" >> /usr/share/nginx/html/index.html\n          # Start nginx\n          nginx -g \'daemon off;\'\n  # Key: VolumeClaimTemplates\n  volumeClaimTemplates:\n  - metadata:\n      name: data                    # PVC name prefix\n    spec:\n      storageClassName: curvine-sc\n      accessModes:\n        - ReadWriteOnce             # Independent storage for each Pod\n      resources:\n        requests:\n          storage: 1Gi\n'})}),"\n",(0,s.jsx)(n.h3,{id:"73-deploy-and-verify",children:"7.3 Deploy and Verify"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# 1. Deploy StatefulSet\nkubectl apply -f statefulset-web-app.yaml\n\n# 2. Watch Pod creation order (created sequentially)\nkubectl get pods -l app=web-app -w\n\n# 3. Check PVCs (auto-created, one per Pod)\nkubectl get pvc\n# Example output:\n# data-web-app-0   Bound    pvc-xxx   1Gi       RWO\n# data-web-app-1   Bound    pvc-yyy   1Gi       RWO\n# data-web-app-2   Bound    pvc-zzz   1Gi       RWO\n\n# 4. Check PVs (auto-created)\nkubectl get pv\n\n# 5. Verify each Pod has independent storage\nfor i in 0 1 2; do\n  echo \"=== Pod web-app-$i ===\"\n  kubectl exec web-app-$i -- cat /usr/share/nginx/html/index.html\ndone\n\n# 6. Write custom data to Pod-0\nkubectl exec web-app-0 -- sh -c \\\n  'echo \"<p>Custom data from Pod-0</p>\" >> /usr/share/nginx/html/index.html'\n\n# 7. Verify Pod-0's data\nkubectl exec web-app-0 -- cat /usr/share/nginx/html/index.html\n\n# 8. Verify Pod-1 doesn't have Pod-0's custom data (independent storage)\nkubectl exec web-app-1 -- cat /usr/share/nginx/html/index.html\n\n# 9. Test persistence: Data remains after deleting Pod-0\nkubectl delete pod web-app-0\n# Wait for Pod to be recreated\nkubectl wait --for=condition=Ready pod/web-app-0 --timeout=60s\n# Verify data still exists\nkubectl exec web-app-0 -- cat /usr/share/nginx/html/index.html\n"})}),"\n",(0,s.jsx)(n.h3,{id:"74-statefulset-features",children:"7.4 StatefulSet Features"}),"\n",(0,s.jsx)(n.h4,{id:"pvc-naming-convention",children:"PVC Naming Convention"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'PVC name = volumeClaimTemplate.name + "-" + StatefulSet.name + "-" + Pod ordinal\n\nExample:\ndata-web-app-0\ndata-web-app-1\ndata-web-app-2\n'})}),"\n",(0,s.jsx)(n.h4,{id:"pod-and-pvc-lifecycle",children:"Pod and PVC Lifecycle"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# 1. Delete Pod, PVC is not deleted\nkubectl delete pod web-app-0\n# Pod is recreated and automatically binds back to the original PVC, data is retained\n\n# 2. Delete StatefulSet, retain PVCs (recommended)\nkubectl delete statefulset web-app --cascade=orphan\n# PVCs and data are retained\n\n# 3. Delete StatefulSet and Pods, but retain PVCs\nkubectl delete statefulset web-app\n# PVCs need manual deletion\n\n# 4. Manually delete PVC\nkubectl delete pvc data-web-app-0\n"})}),"\n",(0,s.jsx)(n.h4,{id:"scaling",children:"Scaling"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# 1. Scale up (increase replicas)\nkubectl scale statefulset web-app --replicas=5\n# Automatically creates web-app-3, web-app-4 and corresponding PVCs\n\n# 2. Scale down (decrease replicas)\nkubectl scale statefulset web-app --replicas=2\n# web-app-2 is deleted, but PVC data-web-app-2 is retained\n\n# 3. Scale up again\nkubectl scale statefulset web-app --replicas=3\n# web-app-2 is recreated and binds back to data-web-app-2, data is restored\n"})}),"\n",(0,s.jsx)(n.h4,{id:"fuse-process-sharing",children:"FUSE Process Sharing"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# Conditions for multiple PVs to share a FUSE process:\n# 1. Same master-addrs\n# 2. Same curvine-path\n\n# Example: These two PVs will share a FUSE process\nPV1:\n  master-addrs: "10.0.0.1:8995"\n  curvine-path: "/shared-data"\n\nPV2:\n  master-addrs: "10.0.0.1:8995"\n  curvine-path: "/shared-data"\n\n# These two PVs will have independent FUSE processes\nPV3:\n  curvine-path: "/data-1"\n\nPV4:\n  curvine-path: "/data-2"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"appendix",children:"Appendix"}),"\n",(0,s.jsx)(n.h3,{id:"helm-custom-parameters",children:"Helm Custom Parameters"}),"\n",(0,s.jsx)(n.h4,{id:"global-settings",children:"Global Settings"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter Path"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"global.namespace"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"curvine-system"})}),(0,s.jsx)(n.td,{children:"Namespace where CSI driver is deployed"})]})})]}),"\n",(0,s.jsx)(n.h4,{id:"image-settings",children:"Image Settings"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter Path"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"image.repository"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ghcr.io/curvineio/curvine-csi"})}),(0,s.jsx)(n.td,{children:"CSI driver image repository address"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"image.tag"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"latest"})}),(0,s.jsx)(n.td,{children:"CSI driver image tag version"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"image.pullPolicy"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Always"})}),(0,s.jsx)(n.td,{children:"Image pull policy (Always/IfNotPresent/Never)"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"csi-driver-settings",children:"CSI Driver Settings"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter Path"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"csiDriver.name"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"curvine"})}),(0,s.jsx)(n.td,{children:"CSI driver name identifier"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"csiDriver.attachRequired"})}),(0,s.jsx)(n.td,{children:"boolean"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{children:"Whether attach operation is required (volume attachment to node)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"csiDriver.podInfoOnMount"})}),(0,s.jsx)(n.td,{children:"boolean"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{children:"Whether Pod information is required during mount"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"controller-settings",children:"Controller Settings"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter Path"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.name"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"curvine-csi-controller"})}),(0,s.jsx)(n.td,{children:"Controller Deployment name"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.replicas"})}),(0,s.jsx)(n.td,{children:"int"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"1"})}),(0,s.jsx)(n.td,{children:"Number of Controller replicas"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.priorityClassName"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"system-cluster-critical"})}),(0,s.jsx)(n.td,{children:"Controller priority class name (high priority)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.container.name"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"csi-plugin"})}),(0,s.jsx)(n.td,{children:"Main container name"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.container.command"})}),(0,s.jsx)(n.td,{children:"array"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'["/opt/curvine/csi"]'})}),(0,s.jsx)(n.td,{children:"Container start command"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.container.args"})}),(0,s.jsx)(n.td,{children:"array"}),(0,s.jsx)(n.td,{children:"See values.yaml"}),(0,s.jsx)(n.td,{children:"Container start arguments"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.container.env.CSI_ENDPOINT"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"unix:///csi/csi.sock"})}),(0,s.jsx)(n.td,{children:"CSI socket endpoint address"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.container.livenessProbe.failureThreshold"})}),(0,s.jsx)(n.td,{children:"int"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"5"})}),(0,s.jsx)(n.td,{children:"Liveness probe failure threshold"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.container.livenessProbe.initialDelaySeconds"})}),(0,s.jsx)(n.td,{children:"int"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"10"})}),(0,s.jsx)(n.td,{children:"Liveness probe initial delay seconds"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.container.livenessProbe.periodSeconds"})}),(0,s.jsx)(n.td,{children:"int"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"10"})}),(0,s.jsx)(n.td,{children:"Liveness probe check period (seconds)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.container.livenessProbe.timeoutSeconds"})}),(0,s.jsx)(n.td,{children:"int"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"3"})}),(0,s.jsx)(n.td,{children:"Liveness probe timeout (seconds)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.container.ports.healthz"})}),(0,s.jsx)(n.td,{children:"int"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"9909"})}),(0,s.jsx)(n.td,{children:"Health check port"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.container.securityContext.privileged"})}),(0,s.jsx)(n.td,{children:"boolean"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"true"})}),(0,s.jsx)(n.td,{children:"Whether to run in privileged mode"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.container.securityContext.capabilities.add"})}),(0,s.jsx)(n.td,{children:"array"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"[SYS_ADMIN]"})}),(0,s.jsx)(n.td,{children:"Added Linux Capabilities"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.tolerations"})}),(0,s.jsx)(n.td,{children:"array"}),(0,s.jsx)(n.td,{children:"See values.yaml"}),(0,s.jsx)(n.td,{children:"Pod toleration configuration (allows CriticalAddons scheduling)"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"controller-sidecar-container-configuration",children:"Controller Sidecar Container Configuration"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter Path"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.sidecars.provisioner.image"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"quay.io/k8scsi/csi-provisioner:v1.6.0"})}),(0,s.jsx)(n.td,{children:"Provisioner sidecar image"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.sidecars.provisioner.args"})}),(0,s.jsx)(n.td,{children:"array"}),(0,s.jsx)(n.td,{children:"See values.yaml"}),(0,s.jsx)(n.td,{children:"Provisioner arguments (timeout 60s, log level v5)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.sidecars.attacher.image"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"registry.k8s.io/sig-storage/csi-attacher:v4.5.0"})}),(0,s.jsx)(n.td,{children:"Attacher sidecar image"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.sidecars.attacher.args"})}),(0,s.jsx)(n.td,{children:"array"}),(0,s.jsx)(n.td,{children:"See values.yaml"}),(0,s.jsx)(n.td,{children:"Attacher arguments (log level v5)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.sidecars.livenessProbe.image"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"registry.k8s.io/sig-storage/livenessprobe:v2.11.0"})}),(0,s.jsx)(n.td,{children:"LivenessProbe sidecar image"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.sidecars.livenessProbe.args"})}),(0,s.jsx)(n.td,{children:"array"}),(0,s.jsx)(n.td,{children:"See values.yaml"}),(0,s.jsx)(n.td,{children:"LivenessProbe arguments"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"controller.sidecars.livenessProbe.env.HEALTH_PORT"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'"9909"'})}),(0,s.jsx)(n.td,{children:"Health check port"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"node-settings",children:"Node Settings"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter Path"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.name"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"curvine-csi-node"})}),(0,s.jsx)(n.td,{children:"Node DaemonSet name"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.priorityClassName"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"system-node-critical"})}),(0,s.jsx)(n.td,{children:"Node priority class name (node critical level)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.dnsPolicy"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ClusterFirstWithHostNet"})}),(0,s.jsx)(n.td,{children:"DNS policy (cluster first + host network)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.container.name"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"csi-plugin"})}),(0,s.jsx)(n.td,{children:"Main container name"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.container.command"})}),(0,s.jsx)(n.td,{children:"array"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'["/opt/curvine/csi"]'})}),(0,s.jsx)(n.td,{children:"Container start command"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.container.args"})}),(0,s.jsx)(n.td,{children:"array"}),(0,s.jsx)(n.td,{children:"See values.yaml"}),(0,s.jsx)(n.td,{children:"Container start arguments"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.container.env.CSI_ENDPOINT"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"unix:///csi/csi.sock"})}),(0,s.jsx)(n.td,{children:"CSI socket endpoint address"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.container.livenessProbe.failureThreshold"})}),(0,s.jsx)(n.td,{children:"int"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"5"})}),(0,s.jsx)(n.td,{children:"Liveness probe failure threshold"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.container.livenessProbe.initialDelaySeconds"})}),(0,s.jsx)(n.td,{children:"int"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"10"})}),(0,s.jsx)(n.td,{children:"Liveness probe initial delay seconds"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.container.livenessProbe.periodSeconds"})}),(0,s.jsx)(n.td,{children:"int"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"10"})}),(0,s.jsx)(n.td,{children:"Liveness probe check period (seconds)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.container.livenessProbe.timeoutSeconds"})}),(0,s.jsx)(n.td,{children:"int"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"3"})}),(0,s.jsx)(n.td,{children:"Liveness probe timeout (seconds)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.container.ports.healthz"})}),(0,s.jsx)(n.td,{children:"int"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"9909"})}),(0,s.jsx)(n.td,{children:"Health check port"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.container.securityContext.privileged"})}),(0,s.jsx)(n.td,{children:"boolean"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"true"})}),(0,s.jsx)(n.td,{children:"Whether to run in privileged mode"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.container.lifecycle.preStop"})}),(0,s.jsx)(n.td,{children:"object"}),(0,s.jsx)(n.td,{children:"See values.yaml"}),(0,s.jsx)(n.td,{children:"Container pre-stop hook (cleanup socket files)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.tolerations"})}),(0,s.jsx)(n.td,{children:"array"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"[{operator: Exists}]"})}),(0,s.jsx)(n.td,{children:"Pod toleration configuration (tolerates all taints)"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"node-sidecar-container-configuration",children:"Node Sidecar Container Configuration"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter Path"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.sidecars.nodeDriverRegistrar.image"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"quay.io/k8scsi/csi-node-driver-registrar:v2.1.0"})}),(0,s.jsx)(n.td,{children:"Node driver registrar image"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.sidecars.nodeDriverRegistrar.args"})}),(0,s.jsx)(n.td,{children:"array"}),(0,s.jsx)(n.td,{children:"See values.yaml"}),(0,s.jsx)(n.td,{children:"Registrar arguments (log level v5)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.sidecars.nodeDriverRegistrar.env.ADDRESS"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/csi/csi.sock"})}),(0,s.jsx)(n.td,{children:"CSI socket address"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.sidecars.nodeDriverRegistrar.env.DRIVER_REG_SOCK_PATH"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/var/lib/kubelet/csi-plugins/csi.curvine.io/csi.sock"})}),(0,s.jsx)(n.td,{children:"Driver registration path in Kubelet"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.sidecars.livenessProbe.image"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"registry.k8s.io/sig-storage/livenessprobe:v2.11.0"})}),(0,s.jsx)(n.td,{children:"LivenessProbe sidecar image"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.sidecars.livenessProbe.args"})}),(0,s.jsx)(n.td,{children:"array"}),(0,s.jsx)(n.td,{children:"See values.yaml"}),(0,s.jsx)(n.td,{children:"LivenessProbe arguments"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.sidecars.livenessProbe.env.ADDRESS"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/csi/csi.sock"})}),(0,s.jsx)(n.td,{children:"CSI socket address"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.sidecars.livenessProbe.env.HEALTH_PORT"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'"9909"'})}),(0,s.jsx)(n.td,{children:"Health check port"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"node-host-path-configuration",children:"Node Host Path Configuration"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter Path"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.hostPaths.pluginDir.path"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/var/lib/kubelet/csi-plugins/csi.curvine.io/"})}),(0,s.jsx)(n.td,{children:"CSI plugin directory path"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.hostPaths.pluginDir.type"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"DirectoryOrCreate"})}),(0,s.jsx)(n.td,{children:"Path type (create if not exists)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.hostPaths.kubeletDir.path"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/var/lib/kubelet"})}),(0,s.jsx)(n.td,{children:"Kubelet working directory path"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.hostPaths.kubeletDir.type"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"DirectoryOrCreate"})}),(0,s.jsx)(n.td,{children:"Path type (create if not exists)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.hostPaths.registrationDir.path"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/var/lib/kubelet/plugins_registry/"})}),(0,s.jsx)(n.td,{children:"Plugin registration directory path"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node.hostPaths.registrationDir.type"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Directory"})}),(0,s.jsx)(n.td,{children:"Path type (must exist)"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"service-account-settings",children:"Service Account Settings"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter Path"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"serviceAccount.controller.name"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"curvine-csi-controller-sa"})}),(0,s.jsx)(n.td,{children:"Controller service account name"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"serviceAccount.node.name"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"curvine-csi-node-sa"})}),(0,s.jsx)(n.td,{children:"Node service account name"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"rbac-configuration",children:"RBAC Configuration"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter Path"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"rbac.create"})}),(0,s.jsx)(n.td,{children:"boolean"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"true"})}),(0,s.jsx)(n.td,{children:"Whether to create RBAC resources (ClusterRole/ClusterRoleBinding)"})]})})]}),"\n",(0,s.jsx)(n.h4,{id:"configmap-configuration-curvine-cluster-configuration",children:"ConfigMap Configuration (Curvine Cluster Configuration)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter Path"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"configMap.name"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"curvine-config"})}),(0,s.jsx)(n.td,{children:"ConfigMap name"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"configMap.defaultMode"})}),(0,s.jsx)(n.td,{children:"octal"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"0755"})}),(0,s.jsx)(n.td,{children:"File default permission mode"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"configMap.data.curvineClusterToml"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"See values.yaml"}),(0,s.jsx)(n.td,{children:"Curvine cluster configuration file (TOML format)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"configMap.data.curvineEnvSh"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"See values.yaml"}),(0,s.jsx)(n.td,{children:"Curvine environment variables script"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"curvine-cluster-configuration-parameters-in-configmap",children:"Curvine Cluster Configuration Parameters in ConfigMap"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Configuration Item"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"client.master_addrs"})}),(0,s.jsx)(n.td,{children:"array"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'[{hostname: "localhost", port: 8995}]'})}),(0,s.jsx)(n.td,{children:"Curvine Master node address list"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"log.level"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'"info"'})}),(0,s.jsx)(n.td,{children:"Log level (debug/info/warn/error)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"log.log_dir"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'"stdout"'})}),(0,s.jsx)(n.td,{children:"Log output directory (stdout for standard output)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"log.file_name"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'"curvine.log"'})}),(0,s.jsx)(n.td,{children:"Log file name"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"storageclass-parameters-configured-at-usage-time",children:"StorageClass Parameters (Configured at Usage Time)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter Name"}),(0,s.jsx)(n.th,{children:"Required"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"master-addrs"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Required"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"None"}),(0,s.jsxs)(n.td,{children:["Curvine Master node addresses, format: ",(0,s.jsx)(n.code,{children:"host:port,host:port"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"fs-path"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Required"})}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"None"}),(0,s.jsxs)(n.td,{children:["Filesystem path prefix, each PV creates: ",(0,s.jsx)(n.code,{children:"fs-path + pv-name"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"path-type"})}),(0,s.jsx)(n.td,{children:"Optional"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Directory"})}),(0,s.jsxs)(n.td,{children:["Path creation strategy: ",(0,s.jsx)(n.code,{children:"DirectoryOrCreate"})," or ",(0,s.jsx)(n.code,{children:"Directory"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"io-threads"})}),(0,s.jsx)(n.td,{children:"Optional"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"None"}),(0,s.jsx)(n.td,{children:"FUSE IO thread count"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"worker-threads"})}),(0,s.jsx)(n.td,{children:"Optional"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"None"}),(0,s.jsx)(n.td,{children:"FUSE worker thread count"})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>d,x:()=>l});var r=i(6540);const s={},t=r.createContext(s);function d(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);