"use strict";(self.webpackChunkcurvine_doc=self.webpackChunkcurvine_doc||[]).push([[3474],{1018:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>s,default:()=>u,frontMatter:()=>c,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"Deploy/Deploy-Curvine-Cluster/Preparation/compile","title":"Download and Compile Curvine","description":"This chapter introduces how to download and compile Curvine.","source":"@site/docs/2-Deploy/2-Deploy-Curvine-Cluster/1-Preparation/02-compile.md","sourceDirName":"2-Deploy/2-Deploy-Curvine-Cluster/1-Preparation","slug":"/Deploy/Deploy-Curvine-Cluster/Preparation/compile","permalink":"/docs/Deploy/Deploy-Curvine-Cluster/Preparation/compile","draft":false,"unlisted":false,"editUrl":"https://github.com/curvineio/curvine-doc/edit/main/docs/2-Deploy/2-Deploy-Curvine-Cluster/1-Preparation/02-compile.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Deployment Architecture","permalink":"/docs/Deploy/Deploy-Curvine-Cluster/Deployment-Architecture"},"next":{"title":"Deployment Preparation","permalink":"/docs/Deploy/Deploy-Curvine-Cluster/Preparation/deployment-setup"}}');var r=i(4848),t=i(8453);const c={sidebar_position:1},s="Download and Compile Curvine",a={},d=[{value:"Supported Linux Distributions",id:"supported-linux-distributions",level:2},{value:"Local Compilation",id:"local-compilation",level:2},{value:"Docker Compilation",id:"docker-compilation",level:2},{value:"1. Using Curvine-provided Compilation Images",id:"1-using-curvine-provided-compilation-images",level:3},{value:"2. Advanced: Build Your Own Compilation Image",id:"2-advanced-build-your-own-compilation-image",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"download-and-compile-curvine",children:"Download and Compile Curvine"})}),"\n",(0,r.jsx)(n.p,{children:"This chapter introduces how to download and compile Curvine."}),"\n",(0,r.jsx)(n.h2,{id:"supported-linux-distributions",children:"Supported Linux Distributions"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"OS Distribution"}),(0,r.jsx)(n.th,{children:"Kernel Requirement"}),(0,r.jsx)(n.th,{children:"Tested Version"}),(0,r.jsx)(n.th,{children:"Dependencies"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"CentOS 7"})}),(0,r.jsx)(n.td,{children:"\u22653.10.0"}),(0,r.jsx)(n.td,{children:"7.6"}),(0,r.jsx)(n.td,{children:"fuse2-2.9.2"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"CentOS 8"})}),(0,r.jsx)(n.td,{children:"\u22654.18.0"}),(0,r.jsx)(n.td,{children:"8.5"}),(0,r.jsx)(n.td,{children:"fuse3-3.9.1"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Rocky Linux 9"})}),(0,r.jsx)(n.td,{children:"\u22655.14.0"}),(0,r.jsx)(n.td,{children:"9.5"}),(0,r.jsx)(n.td,{children:"fuse3-3.10.2"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"RHEL 9"})}),(0,r.jsx)(n.td,{children:"\u22655.14.0"}),(0,r.jsx)(n.td,{children:"9.5"}),(0,r.jsx)(n.td,{children:"fuse3-3.10.2"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Ubuntu 22"})}),(0,r.jsx)(n.td,{children:"\u22655.15.0"}),(0,r.jsx)(n.td,{children:"22.4"}),(0,r.jsx)(n.td,{children:"fuse3-3.10.5"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Download the source code:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/CurvineIO/curvine.git ./\n"})}),"\n",(0,r.jsx)(n.h2,{id:"local-compilation",children:"Local Compilation"}),"\n",(0,r.jsxs)(n.admonition,{type:"warning",children:[(0,r.jsxs)(n.p,{children:["Please ensure that the prerequisite dependencies are installed and configured in the environment variables. For the installation process of related environment dependencies, you can refer to the ",(0,r.jsx)(n.a,{href:"/docs/Deploy/Deploy-Curvine-Cluster/Preparation/prerequisites",children:"Environment Initialization Tutorial"})]}),(0,r.jsx)(n.p,{children:"or"}),(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://github.com/CurvineIO/curvine/blob/main/curvine-docker/compile/Dockerfile_rocky9",children:"Docker Environment Initialization"})})]}),"\n",(0,r.jsxs)(n.p,{children:["Then, use the make command for full compilation. The compiled results are located in ",(0,r.jsx)(n.code,{children:"build/dist"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"make all\n"})}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsxs)(n.p,{children:["For more make parameters, you can type ",(0,r.jsx)(n.code,{children:"make"})," or ",(0,r.jsx)(n.code,{children:"make help"})," to view, as shown below:"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"Environment:\n  make check-env                   - Check build environment dependencies\n\nBuilding:\n  make build ARGS='<args>'         - Build with specific arguments passed to build.sh\n  make all                         - Same as 'make build'\n  make format                      - Format code using pre-commit hooks\n\nDocker:\n  make docker-build                - Build using Docker compilation image\n  make docker-build-cached         - Build using cached Docker compilation image\n  make docker-build-img            - Build compilation Docker image (interactive)\n\nCSI (Container Storage Interface):\n  make csi-build                   - Build curvine-csi Go binary\n  make csi-run                     - Run curvine-csi from source\n  make csi-docker-build            - Build curvine-csi Docker image\n  make csi-docker-push             - Push curvine-csi Docker image\n  make csi-docker                  - Build and push curvine-csi Docker image\n  make csi-docker-fast             - Build curvine-csi Docker image quickly (no push)\n  make csi-fmt                     - Format curvine-csi Go code\n  make csi-vet                     - Run go vet on curvine-csi code\n\nOther:\n  make cargo ARGS='<args>'         - Run arbitrary cargo commands\n  make help                        - Show this help message\n\nParameters:\n  ARGS='<args>'  - Additional arguments to pass to build.sh\n\nExamples:\n  make build                                  - Build entire project in release mode\n  make build ARGS='-d'                       - Build entire project in debug mode\n  make build ARGS='-p server -p client'       - Build only server and client components\n  make build ARGS='-p object'                  - Build S3 object gateway\n  make build ARGS='--package core --ufs s3'   - Build core packages with S3 native SDK\n  make cargo ARGS='test --verbose'            - Run cargo test with verbose output\n  make csi-docker-fast                        - Build curvine-csi Docker image quickly\n"})})]}),"\n",(0,r.jsx)(n.h2,{id:"docker-compilation",children:"Docker Compilation"}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["If your system environment is macOS or Windows, or your Linux version is not in the ",(0,r.jsx)(n.a,{href:"#supported-linux-distributions",children:"supported list"}),", we recommend using Docker compilation. This allows you to operate safely in an isolated environment without affecting your system environment."]})}),"\n",(0,r.jsx)(n.h3,{id:"1-using-curvine-provided-compilation-images",children:"1. Using Curvine-provided Compilation Images"}),"\n",(0,r.jsxs)(n.p,{children:["Curvine provides compilation images based on ",(0,r.jsx)(n.code,{children:"rocky9"})," on DockerHub: ",(0,r.jsx)(n.code,{children:"curvine/curvine-compile:latest"})]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"We recommend using the curvine-compile image as a sandbox development environment, where both compilation and execution run within Docker containers."})}),"\n",(0,r.jsx)(n.p,{children:"For a quick try, you only need to execute:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"make docker-build \n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Persistent Development Container"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd curvine\ndocker run -itd --name curvine-compile \\\n  -u root --privileged=true \\\n  -v .:/workspace \\\n  -w /workspace \\\n  --network host \\\n  curvine/curvine-compile:latest /bin/bash\n\n# The container runs in the background, you can attach directly later\ndocker exec -it curvine-compile /bin/bash\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-advanced-build-your-own-compilation-image",children:"2. Advanced: Build Your Own Compilation Image"}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"If you encounter network environment issues or cannot conveniently use the official Docker images, you can choose to build your own compilation image locally."})}),"\n",(0,r.jsxs)(n.p,{children:["The downloaded code includes various Dockerfiles for building compilation images in the ",(0,r.jsx)(n.code,{children:"curvine-docker/compile"})," directory. You can choose the appropriate file to build a compilation image. Here's an example using Rocky9 to build a compilation image and start a container for compilation:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd curvine/curvine-docker/compile\n\ndocker build -f curvine-docker/compile/Dockerfile_rocky9 -t curvine-compile:rocky9 .\n\ncd ../..\n\ndocker run -itd --name curvine-compile \\\n  -u root --privileged=true \\\n  -v .:/workspace \\\n  -w /workspace \\\n  --network host \\\n  curvine-compile:rock9:latest /bin/bash\n\n# After entering the container\nmake all\n\n# The container runs in the background, you can attach directly later\n# docker exec -it curvine-compile /bin/bash\n"})}),"\n",(0,r.jsxs)(n.admonition,{type:"warning",children:[(0,r.jsx)(n.p,{children:"If there are significant differences between your compilation image's OS version and the host machine's OS version, or they are not from the same distribution, the Docker-compiled artifacts may not run directly on the host machine due to libc or ABI incompatibilities."}),(0,r.jsx)(n.p,{children:"Therefore, for Docker-compiled artifacts, we strongly recommend running them on the same OS version or within Docker containers!"})]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>s});var o=i(6540);const r={},t=o.createContext(r);function c(e){const n=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);